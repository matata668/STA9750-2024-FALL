[
  {
    "objectID": "mp04.html",
    "href": "mp04.html",
    "title": "Mini-Project #04: Monte Carlo-Informed Selection of CUNY Retirement Plans",
    "section": "",
    "text": "We are exploring the financial decision-making process for new faculty at CUNY, who must choose between two retirement plans: the Teacher’s Retirement System (TRS) and the Optional Retirement plan (ORP). This decision is critical and irreversible. Thus, a critical evaluation is essential.\nUsing data-driven methodologies, this report aims to provide insight into the factors influencing the optimal choice for different individuals and scenarios.\nThe analysis relies on the historical data and re sampling to simulate potential outcomes for each retirement plan. Key components of the report includes:"
  },
  {
    "objectID": "mp04.html#task-1-task-2",
    "href": "mp04.html#task-1-task-2",
    "title": "Mini-Project #04: Monte Carlo-Informed Selection of CUNY Retirement Plans",
    "section": "Task 1 & Task 2",
    "text": "Task 1 & Task 2\nWe have registered for AlphaVantage API key, securely stored it, and configured my R environment to interact with the API. By leveraging the AlphaVantage API, I aim to retrieve data such as time series stock information, exchange rates, and other financial metrics to support my project’s objectives, ensuring best practices for security and data handling throughout the process."
  },
  {
    "objectID": "mp04.html#task-2",
    "href": "mp04.html#task-2",
    "title": "Mini-Project #04: Monte Carlo-Informed Selection of CUNY Retirement Plans",
    "section": "Task 2",
    "text": "Task 2\nSimilar to Task 1, we have now registered for the FRED API key, securely stored it, and configured my R environment to interact with the API.\nwe have fetched observations for a chosen data series (e.g., GDP) and organized it into a structured data frame. We are focusing on extracting accurate date-wise values, ensuring the value column is numeric for analysis, and validating the data’s time range through realtime_start and realtime_end."
  },
  {
    "objectID": "mp04.html#task-3-data-acquisition",
    "href": "mp04.html#task-3-data-acquisition",
    "title": "Mini-Project #04: Monte Carlo-Informed Selection of CUNY Retirement Plans",
    "section": "Task 3: Data Acquisition",
    "text": "Task 3: Data Acquisition\nAs our first step we begin by reading the Alpha Vantage and FRED API keys from local files. The current working directory is then dynamically retrieved, and a dedicated data directory is prepared to store output files. The script checks for the existence of this directory and creates it if necessary, establishing a consistent and organized location for saving data retrieved through API calls.\n\n\nCode\n# Load required libraries\nlibrary(httr2)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(lubridate)\nlibrary(tibble)\nlibrary(knitr)\n\n# Get the current working directory\ncurrent_path &lt;- getwd()\n\n# Define the 'data' directory path\ndata_directory &lt;- file.path(current_path, \"data\")\n\n# Check if the directory exists, and create it if it doesn't\nif (!dir.exists(data_directory)) {\n  dir.create(data_directory)\n}\n\nalpha_vantage_api_key &lt;- readLines(file.path(current_path, \"Alpha_Vantage_API_key\"))\nfred_api_key &lt;- readLines(file.path(current_path, \"FRED_API_key\"))"
  },
  {
    "objectID": "mp04.html#function-to-call-api",
    "href": "mp04.html#function-to-call-api",
    "title": "Mini-Project #04: Monte Carlo-Informed Selection of CUNY Retirement Plans",
    "section": "Function to call API",
    "text": "Function to call API\nWe are now calling API to download the historical data for each data inputs mentioned below to begin with our Monte Carlo analysis\n\n\nCode\n#| Code-fold: true\n#| Code-summary: \"show the code\"\n\n# Define functions to fetch data from APIs\n\n# FRED API Function\nfetch_fred_data &lt;- function(series_id, api_key) {\n  response &lt;- request(\"https://api.stlouisfed.org/fred/series/observations\") %&gt;%\n    req_url_query(\n      series_id = series_id,\n      api_key = api_key,\n      file_type = \"json\",\n      observation_start = \"2008-12-31\",\n      observation_end = \"2024-11-30\"\n    ) %&gt;%\n    req_perform() %&gt;%\n    resp_body_json()\n  \n  data &lt;- response$observations %&gt;%\n    purrr::map_df(~ data.frame(date = .x$date, value = as.numeric(.x$value))) %&gt;%\n    dplyr::mutate(date = as.Date(date))\n  \n  return(data)\n}\n\n# AlphaVantage API Function\nfetch_alpha_data &lt;- function(function_type, symbol, api_key) {\n  response &lt;- request(\"https://www.alphavantage.co/query\") %&gt;%\n    req_url_query(\n      'function' = function_type,\n      symbol = symbol,\n      apikey = api_key\n    ) %&gt;%\n    req_perform() %&gt;%\n    resp_body_json()\n  \n  data &lt;- response$`Monthly Adjusted Time Series` %&gt;%\n    tibble::enframe(name = \"date\", value = \"values\") %&gt;%\n    dplyr::mutate(\n      date = as.Date(date),\n      value = as.numeric(purrr::map_chr(values, \"5. adjusted close\"))\n    )\n  \n  return(data)\n}\n\n\n\nAverage Hourly Earning\n\n\nCode\nwage_growth &lt;- fetch_fred_data(\"CES0500000003\", fred_api_key)\nkable(head(wage_growth, 5))\n\n\n\n\n\ndate\nvalue\n\n\n\n\n2008-12-01\n21.94\n\n\n2009-01-01\n21.96\n\n\n2009-02-01\n21.99\n\n\n2009-03-01\n22.06\n\n\n2009-04-01\n22.09\n\n\n\n\n\n\n\nInflation\n\n\nCode\ninflation &lt;- fetch_fred_data(\"CPIAUCSL\", fred_api_key)\nkable(head(inflation,5))\n\n\n\n\n\ndate\nvalue\n\n\n\n\n2008-12-01\n211.398\n\n\n2009-01-01\n211.933\n\n\n2009-02-01\n212.705\n\n\n2009-03-01\n212.495\n\n\n2009-04-01\n212.709\n\n\n\n\n\n\n\nUS Equity Market total returns\n\n\nCode\nus_equity &lt;- fetch_alpha_data(\"TIME_SERIES_MONTHLY_ADJUSTED\",\"SPY\", alpha_vantage_api_key)\nkable(head(us_equity,5))\n\n\n\n\n\n\n\n\n\n\ndate\nvalues\nvalue\n\n\n\n\n2024-12-04\n602.9700 , 607.9100 , 602.3410 , 607.6600 , 607.6600 , 101440179, 0.0000\n607.6600\n\n\n2024-11-29\n571.3200 , 603.3500 , 567.8900 , 602.5500 , 602.5500 , 901761281, 0.0000\n602.5500\n\n\n2024-10-31\n573.4000 , 586.1200 , 565.2700 , 568.6400 , 568.6400 , 976134821, 0.0000\n568.6400\n\n\n2024-09-30\n560.4700 , 574.7100 , 539.4400 , 573.7600 , 573.7600 , 1044167074, 1.7455\n573.7600\n\n\n2024-08-30\n552.5700 , 564.2000 , 510.2700 , 563.6800 , 561.9538 , 1244598926, 0.0000\n561.9538\n\n\n\n\n\n\n\nInternational Equity Market Returns (Nasdaq Global Select via AlphaVantage)\n\n\nCode\nintl_equity &lt;- fetch_alpha_data(\"TIME_SERIES_MONTHLY_ADJUSTED\", \"QQQ\", alpha_vantage_api_key) # Nasdaq ETF\nkable(head(intl_equity,5))\n\n\n\n\n\n\n\n\n\n\ndate\nvalues\nvalue\n\n\n\n\n2024-12-04\n511.0100, 523.5200, 510.6200, 523.2600, 523.2600, 69831287, 0.0000\n523.2600\n\n\n2024-11-29\n485.5000 , 515.5800 , 484.2545 , 509.7400 , 509.7400 , 567729700, 0.0000\n509.7400\n\n\n2024-10-31\n487.7000 , 501.3500 , 477.4000 , 483.8500 , 483.8500 , 660234819, 0.0000\n483.8500\n\n\n2024-09-30\n473.2000 , 493.7000 , 448.1900 , 488.0700 , 488.0700 , 694549166, 0.6769\n488.0700\n\n\n2024-08-30\n471.7600 , 485.5400 , 423.4500 , 476.2700 , 475.6036 , 908585535, 0.0000\n475.6036\n\n\n\n\n\n\n\nBond Market Returns (10-Year Treasury Yields from FRED)\n\n\nCode\nbond_market &lt;- fetch_fred_data(\"DGS10\", fred_api_key) # 10-Year Treasury Constant Maturity\nkable(head(bond_market,5))\n\n\n\n\n\ndate\nvalue\n\n\n\n\n2008-12-31\n2.25\n\n\n2009-01-01\nNA\n\n\n2009-01-02\n2.46\n\n\n2009-01-05\n2.49\n\n\n2009-01-06\n2.51\n\n\n\n\n\n\n\nShort-term Debt Returns (3-Month T-Bills from FRED)\n\n\nCode\nshort_term_debt &lt;- fetch_fred_data(\"TB3MS\", fred_api_key) \nkable(head(short_term_debt,5))\n\n\n\n\n\ndate\nvalue\n\n\n\n\n2008-12-01\n0.03\n\n\n2009-01-01\n0.13\n\n\n2009-02-01\n0.30\n\n\n2009-03-01\n0.21\n\n\n2009-04-01\n0.16\n\n\n\n\n\n\n\nAlign Data to Monthly Frequency and Combined in single dataframe\n\n\nCode\n# Align Data to Monthly Frequency\nalign_to_monthly &lt;- function(data) {\n  data %&gt;%\n    dplyr::mutate(month = floor_date(date, \"month\")) %&gt;%\n    dplyr::group_by(month) %&gt;%\n    dplyr::summarize(value = mean(value, na.rm = TRUE)) %&gt;%\n    dplyr::ungroup() %&gt;%\n    dplyr::rename(date = month)\n}\n\nwage_growth &lt;- align_to_monthly(wage_growth)\ninflation &lt;- align_to_monthly(inflation)\nbond_market &lt;- align_to_monthly(bond_market)\nshort_term_debt &lt;- align_to_monthly(short_term_debt)\nus_equity_align &lt;- align_to_monthly(us_equity)\nintl_equity_align &lt;- align_to_monthly(intl_equity)\n\n# Combine All Data into a Single Data Frame\ncombined_data &lt;- wage_growth %&gt;%\n  dplyr::rename(wage_growth = value) %&gt;%\n  dplyr::left_join(inflation %&gt;% dplyr::rename(inflation = value), by = \"date\") %&gt;%\n  dplyr::left_join(us_equity_align %&gt;% dplyr::rename(us_equity = value), by = \"date\") %&gt;%\n  dplyr::left_join(intl_equity_align %&gt;% dplyr::rename(intl_equity = value), by = \"date\") %&gt;%\n  dplyr::left_join(bond_market %&gt;% dplyr::rename(bond_market = value), by = \"date\") %&gt;%\n  dplyr::left_join(short_term_debt %&gt;% dplyr::rename(short_term_debt = value), by = \"date\")\n\nfile_path &lt;- file.path(data_directory, \"monte_carlo_inputs.csv\")\nwrite.csv(combined_data, file_path, row.names = FALSE)\n\nkable(head(combined_data))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ndate\nwage_growth\ninflation\nus_equity\nintl_equity\nbond_market\nshort_term_debt\n\n\n\n\n2008-12-01\n21.94\n211.398\n67.1092\n25.9052\n2.250000\n0.03\n\n\n2009-01-01\n21.96\n211.933\n61.5986\n25.3129\n2.517500\n0.13\n\n\n2009-02-01\n21.99\n212.705\n54.9799\n23.9802\n2.870000\n0.30\n\n\n2009-03-01\n22.06\n212.495\n59.5698\n26.4547\n2.819545\n0.21\n\n\n2009-04-01\n22.09\n212.709\n65.4879\n29.9099\n2.927143\n0.16\n\n\n2009-05-01\n22.11\n213.022\n69.3159\n30.8696\n3.293000\n0.18"
  },
  {
    "objectID": "mp04.html#task-4",
    "href": "mp04.html#task-4",
    "title": "Mini-Project #04: Monte Carlo-Informed Selection of CUNY Retirement Plans",
    "section": "Task 4",
    "text": "Task 4\nUtilizing the downloaded data for our various inputs,we are now going to analyze and identify their key properties.\n\n\nCode\nfile_path &lt;- file.path(data_directory, \"monte_carlo_inputs.csv\")\ncd &lt;- read.csv(file_path, header = TRUE)\ntibble_data &lt;- as_tibble(cd)\n\n# Convert a character column to Date format\ncombined_data &lt;- tibble_data %&gt;%\n  mutate(date = as.Date(date, format = \"%Y-%m-%d\"))\n\n## Compute summary statistics and reshape into tidy format\nhistorical_stats &lt;- combined_data %&gt;%\n  summarise(\n    avg_wage_growth = mean(wage_growth, na.rm = TRUE),\n    var_wage_growth = var(wage_growth, na.rm = TRUE),\n    high_wage_growth = max(wage_growth, na.rm = TRUE),\n    low_wage_growth = min(wage_growth, na.rm = TRUE),\n    \n    avg_inflation = mean(inflation, na.rm = TRUE),\n    var_inflation = var(inflation, na.rm = TRUE),\n    high_inflation = max(inflation, na.rm = TRUE),\n    low_inflation = min(inflation, na.rm = TRUE),\n    \n    avg_us_equity = mean(us_equity, na.rm = TRUE),\n    var_us_equity = var(us_equity, na.rm = TRUE),\n    high_us_equity = max(us_equity, na.rm = TRUE),\n    low_us_equity = min(us_equity, na.rm = TRUE),\n    \n    avg_intl_equity = mean(intl_equity, na.rm = TRUE),\n    var_intl_equity = var(intl_equity, na.rm = TRUE),\n    high_intl_equity = max(intl_equity, na.rm = TRUE),\n    low_intl_equity = min(intl_equity, na.rm = TRUE),\n    \n    avg_bond_market = mean(bond_market, na.rm = TRUE),\n    var_bond_market = var(bond_market, na.rm = TRUE),\n    high_bond_market = max(bond_market, na.rm = TRUE),\n    low_bond_market = min(bond_market, na.rm = TRUE),\n    \n    avg_short_term_debt = mean(short_term_debt, na.rm = TRUE),\n    var_short_term_debt = var(short_term_debt, na.rm = TRUE),\n    high_short_term_debt = max(short_term_debt, na.rm = TRUE),\n    low_short_term_debt = min(short_term_debt, na.rm = TRUE)\n  ) %&gt;%\n  pivot_longer(\n    everything(),\n    names_to = c(\"metric\", \"statistic\"),\n    names_sep = \"_\",\n    values_to = \"value\"\n  ) %&gt;%\n  pivot_wider(\n    names_from = statistic,\n    values_from = value\n  )\n\n\nfile_path &lt;- file.path(data_directory, \"historical_stats.csv\")\nwrite.csv(historical_stats, file_path, row.names = FALSE)\n\n# Display the summary table\nkable(historical_stats)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nmetric\nwage\ninflation\nus\nintl\nbond\nshort\n\n\n\n\navg\n26.93052\n250.7623\n234.5213\n166.5194\n2.5273295\n1.103298\n\n\nvar\n15.24336\n818.5613\n17730.4843\n15923.7464\n0.8214516\n2.778011\n\n\nhigh\n35.46000\n315.4540\n573.7600\n488.0700\n4.7980952\n5.340000\n\n\nlow\n21.94000\n211.3980\n54.9799\n23.9802\n0.6236364\n0.010000\n\n\n\n\n\n\n\nCode\n# Calculate correlation matrix to measure correlation among the variables\ncorrelation_matrix &lt;- combined_data %&gt;%\n  select(wage_growth, inflation, us_equity, intl_equity, bond_market, short_term_debt) %&gt;%\n  cor(use = \"complete.obs\")\n\n# Print the correlation matrix\nkable(correlation_matrix)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nwage_growth\ninflation\nus_equity\nintl_equity\nbond_market\nshort_term_debt\n\n\n\n\nwage_growth\n1.0000000\n0.9891112\n0.9838384\n0.9736390\n0.2180231\n0.7775356\n\n\ninflation\n0.9891112\n1.0000000\n0.9678133\n0.9528990\n0.3044813\n0.8218272\n\n\nus_equity\n0.9838384\n0.9678133\n1.0000000\n0.9928337\n0.1820846\n0.7211033\n\n\nintl_equity\n0.9736390\n0.9528990\n0.9928337\n1.0000000\n0.1774704\n0.7000740\n\n\nbond_market\n0.2180231\n0.3044813\n0.1820846\n0.1774704\n1.0000000\n0.6478846\n\n\nshort_term_debt\n0.7775356\n0.8218272\n0.7211033\n0.7000740\n0.6478846\n1.0000000\n\n\n\n\n\nCode\nlibrary(gt)\n\n# Convert correlation matrix to a data frame\ncorrelation_df &lt;- as.data.frame(correlation_matrix)\n\nlibrary(DT)\n\n# Convert correlation matrix to a data frame\ncorrelation_df &lt;- as.data.frame(correlation_matrix)\n\n# Render interactive table\ndatatable(correlation_df, caption = \"Correlation Matrix\")\n\n\n\n\n\n\n\nHeat map\nusing the heat map visualization the correlation matrix, shows the strength and direction of relationships between variables. Dark red indicates strong positive correlations (close to 1), such as between intl_equity and us_equity or wage_growth and inflation, suggesting these variables move closely together. Lighter red areas, like the correlations involving bond_market, indicate weaker relationships, meaning these variables are less interdependent. The diagonal values represent perfect self-correlation (value of 1). This heatmap highlights key patterns and relationships, providing a foundation for deeper analysis.\n\n\nCode\n# Load necessary libraries\nlibrary(ggplot2)\nlibrary(reshape2)\n\n# Convert correlation matrix to a long format for ggplot2\ncorrelation_long &lt;- melt(correlation_matrix)\n\n# Plot the heatmap\nheatmap_plot &lt;- ggplot(data = correlation_long, aes(x = Var1, y = Var2, fill = value)) +\n  geom_tile(color = \"white\") +\n  scale_fill_gradient2(low = \"blue\", high = \"red\", mid = \"white\", midpoint = 0,\n                       limit = c(-1, 1), name = \"Correlation\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1)) +\n  labs(title = \"Correlation Heatmap\",\n       x = \"Variables\",\n       y = \"Variables\")\n\nheatmap_path &lt;- file.path(data_directory, \"correlation_heatmap.png\")\nggsave(heatmap_path, plot = heatmap_plot, width = 8, height = 6)\n\nprint(heatmap_plot)\n\n\n\n\n\n\n\n\n\n\n\nTime-series graph\nThe time-series graph provides insights into how these economic factors change over time, showing their trends, growth patterns, and volatility. The most notable observation is the sharp upward trend in us_equity and intl_equity, particularly after 2015, reflecting significant growth in equity markets. In contrast, inflation shows a steady and gradual increase, indicating long-term stability. Meanwhile, bond_market, short_term_debt, and wage_growth remain relatively flat, signifying minimal variation over time. The graph also highlights volatility in equities, likely tied to economic cycles or market events.\n\n\nCode\nlibrary(ggplot2)\n# Plot the time series for each factor to visualize trends\nlong_run_plot &lt;- combined_data %&gt;%\n  tidyr::gather(key = \"factor\", value = \"value\", -date) %&gt;%\n  ggplot(aes(x = date, y = value, color = factor)) +\n  geom_line() +\n  theme_minimal() +\n  labs(\n    title = \"Time Series of Key Economic Factors\",\n    x = \"Date\",\n    y = \"Value\",\n    color = \"Factor\"\n  )\n\n# Display the plot\nprint(long_run_plot)\n\n\n\n\n\n\n\n\n\nThe time-series graph displays the trends and changes over time for each variable, highlighting patterns like growth, stability, or volatility in individual factors. It provides a temporal perspective, allowing us to see how variables evolve and fluctuate across different periods. In contrast, the heatmap visualizes the relationships between variables, showing the strength and direction of their correlations in a static snapshot. Together, these visualizations offer complementary insights: the time-series graph reveals dynamic trends, while the heat map emphasizes inter-variable connections."
  },
  {
    "objectID": "STA 9750- Final project.html",
    "href": "STA 9750- Final project.html",
    "title": "STA 9750- Final project",
    "section": "",
    "text": "Do restaurants play a significant role in contribution to rat infestation?\nNew York City’s ongoing struggle with rat infestations has raised concerns about various contributing factors, one of which is the role of restaurants. Restaurants, by nature, produce significant amounts of food waste, and when waste management practices are inadequate, they create an ideal environment for rats to thrive. In this research, we aim to analyze whether there is a correlation between waste management violations by restaurants and the frequency of rat infestations. Additionally, we will examine if the density of restaurants in a neighborhood significantly influences the number of reported rat sightings.\nThe study will also explore how rat infestations have changed pre- and post-COVID-19. During the pandemic, outdoor dining became a widespread adaptation in NYC, and while it supported businesses, it may have inadvertently provided new opportunities for rats through increased food access and improperly managed waste. By analyzing data on restaurant density, waste violations, and rat complaints over time, we will investigate whether outdoor dining has contributed to the rise in rat infestations in specific areas.\nThrough this analysis, we seek to uncover patterns and relationships that could provide insights into how restaurant practices impact urban rat populations. Identifying these connections is critical for developing targeted interventions to mitigate rat infestations in NYC neighborhoods.\n\nLibraries used\n\nlibrary(tidyverse)\nlibrary(sf)\nlibrary(leaflet)\nlibrary(lubridate)\nlibrary(janitor)\nlibrary(geosphere)\nlibrary(httr)\nlibrary(jsonlite)\nlibrary(readr)\nlibrary(data.table)\nlibrary(stringr)\nlibrary(scales)\nlibrary(gridExtra)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(geosphere)\nlibrary(lubridate)\nlibrary(tidyr)\nlibrary(ggrepel)             \n\nNow, let us load the necessary data set for us to begin our analysis\n\n\nLoading the data\n\n# Get the current working directory\ncurrent_path &lt;- getwd()\n\n# Define the 'data' directory path\ndata_directory &lt;- file.path(current_path, \"Rat_Data\")\n\n# Check if the directory exists, and create it if it doesn't\nif (!dir.exists(data_directory)) {\n  success &lt;- dir.create(data_directory, recursive = TRUE)\n  if (success) {\n    message(\"Directory 'Data' created successfully at: \", data_directory)\n  } else {\n    stop(\"Failed to create directory 'Data'. Check permissions or file system.\")\n  }\n} else {\n  message(\"Directory 'Data' already exists at: \", data_directory)\n}\n\nDirectory 'Data' already exists at: /Users/aachalghimire/GitHub/STA9750-2024-FALL/Rat_Data\n\n\nFetch Rat sightings\n\n# Increase timeout limit to 300 seconds\noptions(timeout = 300)\n\n\n# Define output filenames\nrats_file &lt;- file.path(data_directory, \"Rats_Inspection_Full.csv\")\nrestaurant_file &lt;- file.path(data_directory, \"Restaurant_Inspection_Full.csv\")\n\n# rats_file &lt;- \"Rats_Inspection_Full.csv\"\n# restaurant_file &lt;- \"Restaurant_Inspection_Full.csv\"\n\n# Load and filter the Rats data starting from 2019\nrats_data &lt;- read_csv(rats_file,show_col_types = FALSE)\nrats_filtered_data &lt;- rats_data %&gt;%\n  filter(as.Date(`INSPECTION_DATE`, format = \"%m/%d/%Y\") &gt;= as.Date(\"2019-01-01\"))\n\n\nrats_filtered_file_path &lt;- file.path(data_directory, \"Rats_Inspection_2019_onwards.csv\")\nwrite.csv(rats_filtered_data, rats_filtered_file_path, row.names = FALSE)\nmessage(\"Filtered Rats data saved to 'Rats_Inspection_2019_onwards.csv'\")\n\nFiltered Rats data saved to 'Rats_Inspection_2019_onwards.csv'\n\n# Data 2\n# Load and filter the Restaurant Inspection data starting from 2019\nrestaurant_file &lt;- file.path(data_directory, \"Restaurant_Inspection_Full.csv\")\nrestaurant_data &lt;- read_csv(restaurant_file,show_col_types = FALSE)\nrestaurant_filtered_data &lt;- restaurant_data %&gt;%\n  filter(as.Date(`INSPECTION DATE`, format = \"%m/%d/%Y\") &gt;= as.Date(\"2019-01-01\"))\n\nrestaurant_filtered_file_path &lt;- file.path(data_directory, \"Rats_Inspection_2019_onwards.csv\")\nwrite.csv(restaurant_filtered_data, restaurant_filtered_file_path, row.names = FALSE)\nmessage(\"Filtered Restaurant Inspection data saved to 'Restaurant_Inspection_2019_onwards.csv'\")\n\nFiltered Restaurant Inspection data saved to 'Restaurant_Inspection_2019_onwards.csv'\n\nzipcode_mapping &lt;- read_csv(\"Rat_data/zipcode_borough.csv\", show_col_types = FALSE)  # Mapping of ZIP codes to Boroughs\n\n\n# Step 1: Clean ZIP Codes and Map Boroughs -----------------------------------\nzipcode_mapping &lt;- zipcode_mapping %&gt;%\n  mutate(ZIPCODE = str_trim(as.character(Zipcode)),\n         BOROUGH = str_trim(as.character(Borough)))\n\n# Clean and map restaurant data\nrestaurants_clean &lt;- restaurant_filtered_data %&gt;%\n  mutate(ZIPCODE = str_trim(as.character(ZIPCODE)),\n         ZIPCODE = ifelse(str_length(ZIPCODE) == 5, ZIPCODE, NA)) %&gt;%  # Ensure valid 5-digit ZIP codes\n  filter(!is.na(ZIPCODE)) %&gt;%\n  mutate(BORO = ifelse(is.na(BORO), \n                       zipcode_mapping$BOROUGH[match(ZIPCODE, zipcode_mapping$ZIPCODE)], \n                       BORO))\n\n# Filter for restaurants with Grades B and C\nrestaurants_bc &lt;- restaurants_clean %&gt;%\n  filter(GRADE %in% c(\"B\", \"C\")) %&gt;%\n  group_by(BORO, ZIPCODE) %&gt;%\n  summarise(Restaurants_Grade_BC = n(), .groups = \"drop\")\n\n# Clean and map rat data\nrats_clean &lt;- rats_filtered_data %&gt;%\n  mutate(ZIP_CODE = str_trim(as.character(ZIP_CODE)),\n         ZIP_CODE = ifelse(str_length(ZIP_CODE) == 5, ZIP_CODE, NA)) %&gt;%\n  filter(!is.na(ZIP_CODE), !RESULT %in% c(\"Passed\", \"Failed for Other R\")) %&gt;%\n  mutate(BOROUGH = ifelse(is.na(BOROUGH), \n                          zipcode_mapping$BOROUGH[match(ZIP_CODE, zipcode_mapping$ZIPCODE)], \n                          BOROUGH)) %&gt;%\n  group_by(BOROUGH, ZIP_CODE) %&gt;%\n  summarise(Rat_Density = n(), .groups = \"drop\")\n\n# Step 2: Combine Data -------------------------------------------------------\ncombined_data &lt;- full_join(restaurants_bc, rats_clean, \n                           by = c(\"ZIPCODE\" = \"ZIP_CODE\", \"BORO\" = \"BOROUGH\")) %&gt;%\n  replace_na(list(Restaurants_Grade_BC = 0, Rat_Density = 0))\n\n# Step 3: Generate Plots for Each Borough ------------------------------------\nplot_list &lt;- list()\n\nboroughs &lt;- unique(combined_data$BORO)\n\n# Loop through each borough and create plots\nfor (b in boroughs) {\n  data_borough &lt;- combined_data %&gt;% filter(BORO == b)\n  \n  # Plot 1: Number of Restaurants (Grade B and C) by ZIP Code\n  plot_bc &lt;- ggplot(data_borough, aes(x = ZIPCODE, y = Restaurants_Grade_BC, group = 1)) +\n    geom_line(color = \"blue\", size = 1) +\n    geom_point(color = \"blue\", size = 2) +\n    labs(title = paste(\"Number of Restaurants with Grade B and C -\", b),\n         x = \"ZIP Code\", y = \"Number of Restaurants\") +\n    theme_minimal() +\n    theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 10),\n          plot.title = element_text(size = 12, face = \"bold\")) +\n    scale_y_continuous(labels = comma)\n  \n  # Plot 2: Rat Density by ZIP Code\n  plot_rats &lt;- ggplot(data_borough, aes(x = ZIPCODE, y = Rat_Density, group = 1)) +\n    geom_line(color = \"red\", size = 1) +\n    geom_point(color = \"red\", size = 2) +\n    labs(title = paste(\"Rat Density per ZIP Code -\", b),\n         x = \"ZIP Code\", y = \"Rat Density\") +\n    theme_minimal() +\n    theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 10),\n          plot.title = element_text(size = 12, face = \"bold\")) +\n    scale_y_continuous(labels = comma)\n  \n  # Arrange the two plots vertically (one on top of the other)\n  combined_plot &lt;- grid.arrange(plot_bc, plot_rats, ncol = 1)  # Use ncol = 1 for vertical layout\n  plot_list[[b]] &lt;- combined_plot\n  \n}\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nHypothesis and Learnings from the Graphs\n\nKey Observations Across Boroughs:\n\nBronx:\n\nThe ZIP codes 10457 and 10458 show higher rat density (above 12,000) while also exhibiting a significant number of restaurants with Grade B and C.\nThere seems to be a noticeable link between the increase in rat activity and areas with more restaurants receiving lower grades.\n\nBrooklyn:\n\nZIP codes 11215 and 11222 show the highest rat densities (over 20,000), corresponding to relatively high numbers of restaurants with Grade B and C.\nRat infestations in Brooklyn appear to cluster in specific ZIP codes, suggesting that localized waste management issues may be contributing to the problem.\n\nManhattan:\n\nZIP codes 10013 and 10036 have both the highest number of restaurants with Grade B and C (over 600) and noticeable rat activity.\nDespite a significant concentration of lower-graded restaurants, rat densities remain moderate compared to other boroughs, suggesting more effective urban management in some areas.\n\nQueens:\n\nZIP codes 11385 and 11373 show the highest rat densities and a considerable number of restaurants with Grade B and C.\nRat density appears to peak sharply in specific ZIP codes, correlating with localized concentrations of lower-graded restaurants.\n\nStaten Island:\n\nStaten Island has the lowest rat density across all ZIP codes, with a small number of lower-graded restaurants.\nZIP code 10301 has the highest rat density (600) but relatively fewer restaurants compared to other boroughs.\n\n\n\n\n\nHypothesis:\n\nBoroughs with a higher number of Grade B and C restaurants are more likely to experience elevated rat density, particularly in localized ZIP codes. Poor sanitation practices associated with lower restaurant grades likely contribute to rat infestations.\n\n\n\n\nLearnings:\n\nLocalized Rat Clusters:\n\nRat density is not uniformly distributed; specific ZIP codes within boroughs, such as 10457 (Bronx) and 11215 (Brooklyn), experience disproportionately high rat activity.\n\nBorough-Specific Trends:\n\nManhattan: Despite high restaurant density, rat activity remains moderate.\nBrooklyn and Bronx: Exhibit stronger correlations between rat density and restaurants with lower grades.\nStaten Island: Shows consistently lower rat activity, indicating better overall sanitation.\n\nTargeted Interventions:\n\nZIP codes with high numbers of Grade B and C restaurants should be prioritized for sanitation inspections and waste management improvements to reduce rat activity.\n\n\n\n\n\n\nConclusion:\nThe analysis highlights a positive relationship between the number of restaurants with lower grades (B and C) and rat activity density, especially in high-density boroughs like the Bronx, Brooklyn, and Queens. Effective sanitation practices and targeted interventions in identified ZIP codes are critical to addressing this issue.\n\n# Load required libraries\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(geosphere)\nlibrary(lubridate)\n\n# Data Preprocessing ---------------------------------------------------------\n\n# Filter rat inspections with valid lat/lon and failed results\nrats_filtered_loc &lt;- rats_filtered_data %&gt;%\n  filter(!is.na(LATITUDE) & !is.na(LONGITUDE) & RESULT != \"Passed\") %&gt;%\n  mutate(YEAR = year(mdy_hms(INSPECTION_DATE)))\n\n# Extract outdoor seating violations from restaurants\noutdoor_seating &lt;- restaurant_filtered_data %&gt;%\n  filter(grepl(\"outdoor|seating|sidewalk\", `VIOLATION DESCRIPTION`, ignore.case = TRUE)) %&gt;%\n  filter(!is.na(Latitude) & !is.na(Longitude)) %&gt;%\n  mutate(YEAR = year(mdy(`INSPECTION DATE`)))\n\n# Select coordinates for rats and outdoor seating\noutdoor_coords &lt;- outdoor_seating %&gt;% \n  select(Latitude, Longitude) %&gt;% \n  filter(!is.na(Latitude) & !is.na(Longitude)) %&gt;%\n  na.omit()\n\nrat_coords &lt;- rats_filtered_loc %&gt;% \n  select(LATITUDE, LONGITUDE) %&gt;%\n  filter(!is.na(LATITUDE) & !is.na(LONGITUDE)) %&gt;%\n  na.omit()\n\n# Function to check for nearby rats (100 meters)\nfind_rats_nearby &lt;- function(outdoor_coords, rat_coords, distance_threshold = 100) {\n  # Ensure both inputs are matrices with exactly two columns\n  rat_coords &lt;- as.matrix(rat_coords[, c(1, 2)])\n  outdoor_coords &lt;- as.matrix(outdoor_coords[, c(1, 2)])\n  \n  # Validate column names and types\n  if (ncol(rat_coords) != 2 | ncol(outdoor_coords) != 2) {\n    stop(\"Error: Inputs must have exactly two columns (latitude, longitude).\")\n  }\n  \n  result &lt;- sapply(1:nrow(outdoor_coords), function(i) {\n    point &lt;- outdoor_coords[i, ]  # Current restaurant coordinates\n    distances &lt;- distHaversine(matrix(point, nrow = 1), rat_coords)  # Distance to all rat points\n    any(distances &lt;= distance_threshold)  # TRUE if within threshold\n  })\n  return(result)\n}\n\n# Apply the corrected function\noutdoor_seating$RAT_INFESTATION_NEARBY &lt;- find_rats_nearby(outdoor_coords, rat_coords)\n\n# Group by year and count rat infestations near outdoor seating violations\nrat_summary &lt;- outdoor_seating %&gt;%\n  filter(RAT_INFESTATION_NEARBY == TRUE) %&gt;%\n  group_by(YEAR) %&gt;%\n  summarise(Rat_Infestations = n())\n\n# Summarize total outdoor seating violations by year\noutdoor_summary &lt;- outdoor_seating %&gt;%\n  group_by(YEAR) %&gt;%\n  summarise(Outdoor_Violations = n())\n\n# Combine the two summaries\ncombined_summary &lt;- full_join(outdoor_summary, rat_summary, by = \"YEAR\") %&gt;%\n  replace_na(list(Outdoor_Violations = 0, Rat_Infestations = 0))\n\n# Visualization --------------------------------------------------------------\nggplot(combined_summary, aes(x = YEAR)) +\n  geom_bar(aes(y = Outdoor_Violations, fill = \"Outdoor Violations\"), \n           stat = \"identity\", position = \"dodge\") +\n  geom_line(aes(y = Rat_Infestations, color = \"Rat Infestations\"), size = 1) +\n  scale_fill_manual(values = c(\"Outdoor Violations\" = \"steelblue\")) +\n  scale_color_manual(values = c(\"Rat Infestations\" = \"red\")) +\n  geom_rect(aes(xmin = 2020, xmax = 2022, ymin = 0, ymax = Inf), \n            fill = \"gray\", alpha = 0.2) +\n  labs(title = \"Impact of Outdoor Seating on Rat Infestation Rates\",\n       subtitle = \"Highlighted COVID Period (2020-2022)\",\n       x = \"Year\", y = \"Count\",\n       fill = \"Legend\", color = \"Legend\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nKey Observations:\n\nOutdoor Violations:\n\nThere was a clear increase in outdoor seating violations after 2022.\nThe violations appear to be highest in 2024, following a gradual rise from 2022 to 2024.\n\nRat Infestation Rates:\n\nRat infestations near outdoor seating violations also showed a consistent upward trend, increasing sharply in 2023 and 2024.\nThe correlation suggests that as outdoor seating violations increase, rat infestations also rise.\n\nCOVID Period (2020-2022):\n\nThe shaded gray area highlights the COVID period (2020-2022), where the counts of outdoor seating violations and rat infestations were relatively lower compared to post-COVID years.\nPost-2022, there is a notable rise in both outdoor violations and rat infestations.\n\n\n\n\nHypothesis:\n\nThe increase in outdoor seating violations after COVID (2020-2022) may have contributed to higher rat infestation rates. This could be due to improper waste management and sanitation practices around outdoor dining areas.\n\n\n\nLearning:\n\nPost-COVID Recovery: The rise in outdoor dining regulations and activity likely exacerbated rat infestations, emphasizing the importance of effective waste management.\nPreventative Measures: To mitigate rat infestations, stricter enforcement of sanitation protocols for outdoor seating areas is necessary, especially in periods of increased outdoor dining activity.\n\n\n# Step 1: Prepare ZIP Code Mapping -------------------------------------------\nzipcode_mapping &lt;- zipcode_mapping %&gt;%\n  mutate(ZIPCODE = str_trim(as.character(Zipcode)),\n         BOROUGH = str_trim(as.character(Borough)))\n\n# Step 2: Fill NA or Invalid BORO in Restaurant Data -------------------------\nrestaurant_filtered_zb &lt;- restaurant_filtered_data %&gt;%\n  mutate(ZIPCODE = str_trim(as.character(ZIPCODE)),  # Trim and convert ZIPCODE\n         BORO = ifelse(is.na(BORO) | BORO == \"0\", \n                       coalesce(zipcode_mapping$BOROUGH[match(ZIPCODE, zipcode_mapping$ZIPCODE)], BORO),\n                       BORO))\n\n# Step 3: Fill NA or Invalid BOROUGH in Rat Data -----------------------------\nrats_filtered_zb &lt;- rats_filtered_data %&gt;%\n  mutate(ZIP_CODE = str_trim(as.character(ZIP_CODE)),  # Trim and convert ZIP_CODE\n         BOROUGH = coalesce(zipcode_mapping$BOROUGH[match(ZIP_CODE, zipcode_mapping$ZIPCODE)], BOROUGH))\n\n\n# Step 2: Filter Rat Data for Rat Activity -----------------------------------\nrat_activity &lt;- rats_filtered_zb %&gt;%\n  filter(!RESULT %in% c(\"Passed\", \"Failed for Other R\")) %&gt;%\n  filter(!is.na(LATITUDE) & !is.na(LONGITUDE)) %&gt;%\n  group_by(BOROUGH) %&gt;%\n  summarise(Rat_Activity_Count = n())\n\n# Step 3: Aggregate Restaurant Data by Borough ------------------------------\nrestaurant_density &lt;- restaurant_filtered_zb %&gt;%\n  filter(!is.na(Latitude) & !is.na(Longitude)) %&gt;%\n  group_by(BORO) %&gt;%\n  summarise(Restaurant_Count = n())\n\n# Step 4: Merge Data ---------------------------------------------------------\ndensity_data &lt;- restaurant_density %&gt;%\n  mutate(BORO = str_to_lower(str_trim(BORO))) %&gt;%\n  inner_join(\n    rat_activity %&gt;%\n      mutate(BOROUGH = str_to_lower(str_trim(BOROUGH))),\n    by = c(\"BORO\" = \"BOROUGH\")\n  )\n\n# Step 5: Visualization ------------------------------------------------------\n\nggplot(density_data, aes(x = Restaurant_Count, y = Rat_Activity_Count, label = BORO)) +\n  geom_point(size = 4, color = \"blue\") +                               # Scatter points\n  geom_smooth(method = \"lm\", color = \"red\", se = TRUE) +               # Trendline with confidence interval\n  geom_text_repel(aes(label = paste0(BORO, \" (\", Restaurant_Count, \", \", Rat_Activity_Count, \")\")),\n                  size = 4, color = \"black\", box.padding = 0.5) +      # Add BORO and coordinates\n  scale_y_continuous(labels = comma) +                                 # Format y-axis as whole numbers\n  scale_x_continuous(labels = comma) +                                 # Format x-axis as whole numbers\n  labs(title = \"Density of Restaurants vs Rat Activity\",\n       subtitle = \"Analyzing Relationship Between Restaurants and Rat Infestation Rates\",\n       x = \"Number of Restaurants (Density)\",\n       y = \"Number of Rat Activity Inspections\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\nKey Observations:\n\nPositive Correlation:\n\nThe graph shows a slight positive correlation between the number of restaurants (restaurant density) and the number of rat activity inspections.\nBoroughs with higher restaurant density, such as Manhattan and Brooklyn, also exhibit higher rat activity inspections.\n\nManhattan and Brooklyn:\n\nThese boroughs have the highest restaurant densities (e.g., Manhattan: ~94,661 restaurants) and significant rat activity counts (e.g., 136,963 inspections).\nThis suggests that areas with concentrated restaurant activity may experience increased rat infestations due to factors such as waste generation.\n\nLow-Density Areas:\n\nStaten Island has the lowest restaurant density (~9,218 restaurants) and rat activity inspections (~2,049). This aligns with the general trend that lower restaurant density areas tend to have lower rat activity.\n\nOutliers:\n\nThe Bronx appears to have a higher number of rat activity inspections relative to its restaurant density (~23,274 restaurants, ~96,498 inspections). This could indicate other contributing factors, such as waste management issues or urban infrastructure challenges.\n\n\n\n\n\nHypothesis:\n\nHigher restaurant density contributes to increased rat activity due to improper waste management, food availability, and urban environmental factors.\n\n\n\n\nLearning:\n\nTargeted Waste Management Policies: Boroughs with higher restaurant density, like Manhattan and Brooklyn, require stricter waste management practices to mitigate rat infestations.\nFurther Investigation: The Bronx’s higher rat activity relative to restaurant density warrants further analysis into non-restaurant-related factors contributing to infestations."
  },
  {
    "objectID": "individual_report.html",
    "href": "individual_report.html",
    "title": "Final Individual Report",
    "section": "",
    "text": "New York City restaurant’s persistent struggle with rat infestations has raised concerns about various contributing factors, particularly the role of restaurants. By their nature, restaurants generate significant food waste, and when sanitation practices are inadequate, they create ideal conditions for rats to thrive. This research examines the correlation between restaurant sanitation grades (B and C) and rat activity, as well as the influence of restaurant density on reported rat sightings across neighborhoods.\nThe study also explores the impact of outdoor dining, which expanded significantly during the COVID-19 pandemic. While outdoor dining supported businesses, it may have inadvertently contributed to rat infestations by increasing food access and improperly managed waste. By analyzing trends in restaurant grades, density, and rat activity over time, we aim to determine whether outdoor dining has exacerbated the rat problem in certain areas.\nThrough this analysis, we seek to identify patterns and relationships that highlight how restaurant practices contribute to urban rat populations. These insights are critical for developing targeted interventions to mitigate rat infestations and improve public health across NYC neighborhoods.\n\n\n\n\nshow the code\nlibrary(tidyverse)\nlibrary(sf)\nlibrary(leaflet)\nlibrary(lubridate)\nlibrary(janitor)\nlibrary(geosphere)\nlibrary(httr)\nlibrary(jsonlite)\nlibrary(readr)\nlibrary(data.table)\nlibrary(stringr)\nlibrary(scales)\nlibrary(gridExtra)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(geosphere)\nlibrary(lubridate)\nlibrary(tidyr)\nlibrary(ggrepel) \nlibrary(knitr)\n\n\n\n\n\n\n\nshow the code\n# Get the current working directory\ncurrent_path &lt;- getwd()\n\n# Define the 'data' directory path\ndata_directory &lt;- file.path(current_path, \"Rat_Data\")\n\n# Check if the directory exists, and create it if it doesn't\nif (!dir.exists(data_directory)) {\n  success &lt;- dir.create(data_directory, recursive = TRUE)\n  if (success) {\n    message(\"Directory 'Data' created successfully at: \", data_directory)\n  } else {\n    stop(\"Failed to create directory 'Data'. Check permissions or file system.\")\n  }\n} else {\n  message(\"Directory 'Data' already exists at: \", data_directory)\n}\n\n\nData Sources and Rationale \nWe are automating data analysis using two publicly available data sets from NYC Open Data:\n\nDOHMH New York City Restaurant Inspection Results\nRats activity recorded in restaurants by borough\n\nWe chose these data sets because they contain detailed information about rat infestations in New York City, collected by the NYC Department of Health and Mental Hygiene (DOHMH), Division of Environmental Health Pest Control. By leveraging this data, we aim to analyze the prevalence and distribution of rat activity across various NYC neighborhoods.\nMethodology\nWe focus on inspection data from 2019, extracting relevant columns and combining the two data sets using zip codes as the common key for integration. The combined data is then cleaned and pre-processed to align with the requirements of our analysis.\nData Limitations\nInspection Bias: The data set does not indicate the absence of rats in areas that were not inspected. This can create an illusion of lower rat activity in neighborhoods with fewer inspections. Similarly, areas with higher rates of active rat signs may reflect more frequent inspections rather than a genuinely higher rat population.\nMissing Data: A significant number of empty rows exist within the datasets, which necessitates careful and thorough cleaning to ensure the accuracy and reliability of our analysis. By addressing these limitations and ensuring a robust data-cleaning process, we aim to produce meaningful insights into rat infestation patterns and their correlations with restaurant inspection data.\n\n\nshow the code\n# Increase timeout limit to 300 seconds\noptions(timeout = 300)\n\n\n# Define output filenames\nrats_file &lt;- file.path(data_directory, \"Rats_Inspection_Full.csv\")\nrestaurant_file &lt;- file.path(data_directory, \"Restaurant_Inspection_Full.csv\")\n\n# rats_file &lt;- \"Rats_Inspection_Full.csv\"\n# restaurant_file &lt;- \"Restaurant_Inspection_Full.csv\"\n\n# Load and filter the Rats data starting from 2019\nrats_data &lt;- read_csv(rats_file,show_col_types=FALSE)\nrats_filtered_data &lt;- rats_data %&gt;%\n  filter(as.Date(`INSPECTION_DATE`, format = \"%m/%d/%Y\") &gt;= as.Date(\"2019-01-01\"))\n\n\nrats_filtered_file_path &lt;- file.path(data_directory, \"Rats_Inspection_2019_onwards.csv\")\nwrite.csv(rats_filtered_data, rats_filtered_file_path, row.names=FALSE)\n#message(\"Filtered Rats data saved to 'Rats_Inspection_2019_onwards.csv'\")\n\n\n# Data 2\n# Load and filter the Restaurant Inspection data starting from 2019\nrestaurant_file &lt;- file.path(data_directory, \"Restaurant_Inspection_Full.csv\")\nrestaurant_data &lt;- read_csv(restaurant_file,show_col_types=FALSE)\nrestaurant_filtered_data &lt;- restaurant_data %&gt;%\n  filter(as.Date(`INSPECTION DATE`, format = \"%m/%d/%Y\") &gt;= as.Date(\"2019-01-01\"))\n\nrestaurant_filtered_file_path &lt;- file.path(data_directory, \"Rats_Inspection_2019_onwards.csv\")\nwrite.csv(restaurant_filtered_data, restaurant_filtered_file_path, row.names=FALSE)\n#message(\"Filtered Restaurant Inspection data saved to 'Restaurant_Inspection_2019_onwards.csv'\")\n\n\nzipcode_mapping &lt;- read_csv(\"Rat_data/zipcode_borough.csv\", show_col_types=FALSE)  # Mapping of ZIP codes to Boroughs\n# \nkable(head( rats_filtered_data,5))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nINSPECTION_TYPE\nJOB_TICKET_OR_WORK_ORDER_ID\nJOB_ID\nJOB_PROGRESS\nBBL\nBORO_CODE\nBLOCK\nLOT\nHOUSE_NUMBER\nSTREET_NAME\nZIP_CODE\nX_COORD\nY_COORD\nLATITUDE\nLONGITUDE\nBOROUGH\nINSPECTION_DATE\nRESULT\nAPPROVED_DATE\nLOCATION\nCOMMUNITY BOARD\nCOUNCIL DISTRICT\nCENSUS TRACT\nBIN\nNTA\n\n\n\n\nInitial\n13661515\nPC8122655\n1\nNA\n1\n00529\n0009\nNA\nNA\n0\nNA\nNA\nNA\nNA\nManhattan\n06/07/2023 04:36:13 PM\nPassed\n06/08/2023 10:38:30 AM\nNA\nNA\nNA\nNA\nNA\nNA\n\n\nInitial\n13264492\nPC7744572\n1\nNA\n2\n02857\n0095\n0000\nJEROME AVENUE\nNA\nNA\nNA\n0\n0\nBronx\n07/28/2021 12:48:53 PM\nPassed\n07/29/2021 01:19:32 PM\n(0.0, 0.0)\nNA\nNA\nNA\nNA\nNA\n\n\nInitial\n13252138\nPC7732344\n1\nNA\n2\n02409\n0059\nNA\nNA\n10451\nNA\nNA\nNA\nNA\nBronx\n07/07/2021 08:49:45 AM\nPassed\n07/08/2021 10:18:56 AM\nNA\nNA\nNA\nNA\nNA\nNA\n\n\nInitial\n13432908\nPC7906420\n1\nNA\n2\n02420\n0078\n0000\nEAST 161 STREET\nNA\nNA\nNA\n0\n0\nBronx\n07/19/2022 01:50:56 PM\nPassed\n07/20/2022 11:03:35 AM\n(0.0, 0.0)\nNA\nNA\nNA\nNA\nNA\n\n\nInitial\n13392717\nPC7869938\n1\nNA\n2\n02509\n0044\n0000\nWOODYCREST AVENUE\nNA\nNA\nNA\n0\n0\nBronx\n05/20/2022 01:08:51 PM\nPassed\n05/23/2022 10:36:46 AM\n(0.0, 0.0)\nNA\nNA\nNA\nNA\nNA\n\n\n\n\n\nshow the code\nkable(head( restaurant_filtered_data,5))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCAMIS\nDBA\nBORO\nBUILDING\nSTREET\nZIPCODE\nPHONE\nCUISINE DESCRIPTION\nINSPECTION DATE\nACTION\nVIOLATION CODE\nVIOLATION DESCRIPTION\nCRITICAL FLAG\nSCORE\nGRADE\nGRADE DATE\nRECORD DATE\nINSPECTION TYPE\nLatitude\nLongitude\nCommunity Board\nCouncil District\nCensus Tract\nBIN\nBBL\nNTA\nLocation Point1\n\n\n\n\n50105051\nThe Legend Lounge\nManhattan\n2509\nADAM CLAYTON POWELL JR BOULEVARD\nNA\n7186712232\nOther\n12/17/2021\nViolations were cited in the following area(s).\n15E2\nFlavored tobacco products sold or offered for sale\nNot Applicable\nNA\nNA\nNA\n12/07/2024\nSmoke-Free Air Act / Initial Inspection\n0.00000\n0.00000\nNA\nNA\nNA\nNA\n1\nNA\nNA\n\n\n40376515\nAMERICAN MUSEUM OF NATURAL HISTORY FOOD COURT\nManhattan\nNA\nW 79 STREET\n10024\n2127695370\nAmerican\n06/21/2023\nNo violations were recorded at the time of this inspection.\nNA\nNA\nNot Applicable\n0\nA\n06/21/2023\n12/07/2024\nCycle Inspection / Initial Inspection\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\n\n\n41574266\nMOMOFUKU MILK BAR\nManhattan\n251\nEAST 13 STREET\n10003\n3475779504\nCoffee/Tea\n10/12/2024\nNo violations were recorded at the time of this inspection.\nNA\nNA\nNot Applicable\n0\nNA\nNA\n12/07/2024\nInter-Agency Task Force / Initial Inspection\n40.73212\n-73.98654\n103\n02\n004000\n1006911\n1004690037\nMN22\nNA\n\n\n50133642\nMATCHA Cafe MAIKO\nQueens\n13333\n39TH AVE\n11354\n3473998961\nCoffee/Tea\n10/05/2024\nNo violations were recorded at the time of this inspection.\nNA\nNA\nNot Applicable\n0\nNA\nNA\n12/07/2024\nInter-Agency Task Force / Initial Inspection\n40.75911\n-73.83416\n407\n20\n087100\n4000000\n4049727504\nQN22\nNA\n\n\n41081510\nCHOP’T\nManhattan\n60\nEAST 56 STREET\n10022\n2127502467\nSalads\n03/03/2022\nViolations were cited in the following area(s).\n02B\nHot food item not held at or above 140º F.\nCritical\n10\nA\n03/03/2022\n12/07/2024\nCycle Inspection / Re-inspection\n40.76135\n-73.97226\n105\n04\n010200\n1035773\n1012910045\nMN17\nNA\n\n\n\n\n\n\n\n\n\n\n\nBoroughs with a higher number of Grade B and C restaurants are more likely to experience elevated rat sighting, particularly in localized ZIP codes. Poor sanitation practices associated with lower restaurant grades likely contribute to rat infestations.\n\nTo address the limitations of missing data and analyze the relationship between poor restaurant sanitation and rat activity, we focused on restaurants with Grades B and C and rat density across ZIP Codes in the five boroughs of New York City: Bronx, Brooklyn, Manhattan, Queens, and Staten Island.\nData Cleaning and Standardization\n\nZIP Code Validation: The data was cleaned and standardized to ensure all ZIP Codes were valid and accurately mapped to their respective boroughs using a ZIP\nCode-to-borough mapping file.\nRestaurant Sanitation Data:\nRestaurants receiving sanitation Grades B and C, which indicate lower sanitation standards, were filtered and counted for each ZIP Code.\nRat Density Data: Rat activity data was filtered to exclude inspections resulting in “Passed” or “Failed for Other R” outcomes. This provided a more\nreliable measure of rat activity by focusing on confirmed rodent sightings or infestations.\n\nMerging and Analysis\nThe cleaned restaurant sanitation data and rat density data were merged using ZIP Codes as the key. This integration allowed us to directly compare the number of restaurants with lower sanitation grades to rat activity within each ZIP Code.\nThis process ensured a comprehensive analysis of how poor sanitation practices in restaurants might correlate with increased rat infestations across New York City neighborhoods.\n\n\nshow the code\n# Step 1: Clean ZIP Codes and Map Boroughs -----------------------------------\nzipcode_mapping &lt;- zipcode_mapping %&gt;%\n  mutate(ZIPCODE = str_trim(as.character(Zipcode)),\n         BOROUGH = str_trim(as.character(Borough)))\n\n# Clean and map restaurant data\nrestaurants_clean &lt;- restaurant_filtered_data %&gt;%\n  mutate(ZIPCODE = str_trim(as.character(ZIPCODE)),\n         ZIPCODE = ifelse(str_length(ZIPCODE) == 5, ZIPCODE, NA)) %&gt;%  # Ensure valid 5-digit ZIP codes\n  filter(!is.na(ZIPCODE)) %&gt;%\n  mutate(BORO = ifelse(is.na(BORO), \n                       zipcode_mapping$BOROUGH[match(ZIPCODE, zipcode_mapping$ZIPCODE)], \n                       BORO))\n\n# Filter for restaurants with Grades B and C\nrestaurants_bc &lt;- restaurants_clean %&gt;%\n  filter(GRADE %in% c(\"B\", \"C\")) %&gt;%\n  group_by(BORO, ZIPCODE) %&gt;%\n  summarise(Restaurants_Grade_BC = n(), .groups = \"drop\")\n\n# Clean and map rat data\nrats_clean &lt;- rats_filtered_data %&gt;%\n  mutate(ZIP_CODE = str_trim(as.character(ZIP_CODE)),\n         ZIP_CODE = ifelse(str_length(ZIP_CODE) == 5, ZIP_CODE, NA)) %&gt;%\n  filter(!is.na(ZIP_CODE), !RESULT %in% c(\"Passed\", \"Failed for Other R\")) %&gt;%\n  mutate(BOROUGH = ifelse(is.na(BOROUGH), \n                          zipcode_mapping$BOROUGH[match(ZIP_CODE, zipcode_mapping$ZIPCODE)], \n                          BOROUGH)) %&gt;%\n  group_by(BOROUGH, ZIP_CODE) %&gt;%\n  summarise(Rat_Density = n(), .groups = \"drop\")\n\n# Step 2: Combine Data -------------------------------------------------------\ncombined_data &lt;- full_join(restaurants_bc, rats_clean, \n                           by = c(\"ZIPCODE\" = \"ZIP_CODE\", \"BORO\" = \"BOROUGH\")) %&gt;%\n  replace_na(list(Restaurants_Grade_BC = 0, Rat_Density = 0))\n\nkable(head(combined_data, 5))\n\n\n\n\n\nBORO\nZIPCODE\nRestaurants_Grade_BC\nRat_Density\n\n\n\n\nBronx\n10451\n103\n4515\n\n\nBronx\n10452\n105\n9205\n\n\nBronx\n10453\n93\n7843\n\n\nBronx\n10454\n91\n1907\n\n\nBronx\n10455\n132\n3159\n\n\n\n\n\nshow the code\n# Step 3: Generate Plots for Each Borough ------------------------------------\nplot_list &lt;- list()\n\nboroughs &lt;- unique(combined_data$BORO)\n\n# Loop through each borough and create plots\nfor (b in boroughs) {\n  data_borough &lt;- combined_data %&gt;% filter(BORO == b)\n  \n  # Plot 1: Number of Restaurants (Grade B and C) by ZIP Code\n  plot_bc &lt;- ggplot(data_borough, aes(x = ZIPCODE, y = Restaurants_Grade_BC, group = 1)) +\n    geom_line(color = \"blue\", size = 1) +\n    geom_point(color = \"blue\", size = 2) +\n    labs(title = paste(\"Number of Restaurants with Grade B and C -\", b),\n         x = \"ZIP Code\", y = \"Number of Restaurants\") +\n    theme_minimal() +\n    theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 10),\n          plot.title = element_text(size = 12, face = \"bold\")) +\n    scale_y_continuous(labels = comma)\n  \n  # Plot 2: Rat Density by ZIP Code\n  plot_rats &lt;- ggplot(data_borough, aes(x = ZIPCODE, y = Rat_Density, group = 1)) +\n    geom_line(color = \"red\", size = 1) +\n    geom_point(color = \"red\", size = 2) +\n    labs(title = paste(\"Rat Sighting per ZIP Code -\", b),\n         x = \"ZIP Code\", y = \"Rat Sighting\") +\n    theme_minimal() +\n    theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 10),\n          plot.title = element_text(size = 12, face = \"bold\")) +\n    scale_y_continuous(labels = comma)\n  \n  # Arrange the two plots vertically (one on top of the other)\n  combined_plot &lt;- grid.arrange(plot_bc, plot_rats, ncol = 1)  # Use ncol = 1 for vertical layout\n  plot_list[[b]] &lt;- combined_plot\n  \n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nshow the code\noptions(tigris_progress = FALSE)\n\n\nlibrary(tigris)     # Fetch borough boundaries\nlibrary(sf)         # Spatial data\nlibrary(dplyr)      # Data manipulation\nlibrary(ggplot2)    # Visualization\nlibrary(ggrepel)    # Improved text labels\nlibrary(zipcodeR)   # st want to Fetch latitude/longitude for ZIP codes\nlibrary(gganimate)  # Animation\n#options(gganimate.dev = gifski_renderer())\nlibrary(transformr) # Smooth animations\nlibrary(gifski)\nlibrary(av)\n\n\n# Step 1: Fetch NYC Borough Boundaries -----------------------------------------\nnyc_boroughs &lt;- counties(state = \"NY\", cb = TRUE, resolution = \"5m\", year = 2022) %&gt;%\n  filter(NAME %in% c(\"Bronx\", \"Kings\", \"New York\", \"Queens\", \"Richmond\")) # NYC counties\n\n# Calculate centroid of each borough for annotation\nborough_centroids &lt;- nyc_boroughs %&gt;%\n  st_centroid() %&gt;%\n  st_coordinates() %&gt;%\n  as.data.frame() %&gt;%\n  bind_cols(Borough = nyc_boroughs$NAME)\n\n# Step 2: Filter High-Density Data ---------------------------------------------\n# Filter for areas with high restaurant density and rat population\nhigh_density_data &lt;- combined_data %&gt;%\n  filter(Restaurants_Grade_BC &gt; 100 & Rat_Density &gt; 500)\n\n# Step 3: Add Coordinates to ZIP Codes -----------------------------------------\n# Fetch latitude and longitude for ZIP codes using zipcodeR\nhigh_density_data &lt;- high_density_data %&gt;%\n  mutate(coords = purrr::map(ZIPCODE, reverse_zipcode)) %&gt;%\n  tidyr::unnest_wider(coords) %&gt;% \n  filter(!is.na(lat) & !is.na(lng)) %&gt;% # Ensure valid coordinates\n  rename(Longitude = lng, Latitude = lat) %&gt;%\n  arrange(BORO, ZIPCODE) %&gt;%  # Arrange for animation\n  mutate(step = row_number()) # Add animation sequence\n\n# Update borough names\nborough_centroids &lt;- borough_centroids %&gt;%\n  mutate(Borough = case_when(\n    Borough == \"New York\" ~ \"Manhattan\",\n    Borough == \"Kings\" ~ \"Brooklyn\",\n    Borough == \"Richmond\" ~ \"Staten Island\",\n    TRUE ~ Borough\n  ))\n\n# Step 4: Create the Animated Map with Borough Annotations ---------------------\nanimated_map &lt;- ggplot() +\n  # Plot borough boundaries\n  geom_sf(data = nyc_boroughs, fill = \"lightgray\", color = \"white\") +\n  \n  # Add borough names at centroid positions\n  geom_text(data = borough_centroids, \n            aes(x = X, y = Y, label = Borough), \n            color = \"black\", size = 5, fontface = \"bold\") +\n\n  # Add animated pins for high-density areas\n  geom_point(data = high_density_data, \n             aes(x = Longitude, y = Latitude, group = step), \n             color = \"red\", size = 3) +\n  \n  # Add ZIP Code labels\n  geom_text_repel(data = high_density_data, \n                  aes(x = Longitude, y = Latitude, label = ZIPCODE), \n                  size = 3) +\n  \n  # Titles and captions\n  labs(title = \"High-Density Restaurant and Rat Population Areas in NYC\",\n       subtitle = \"Sequential display of ZIP Codes with high density\",\n       caption = \"Data Source: NYC Open Data & tigris\") +\n  \n  # Animation\n  transition_reveal(along = step) +  # Sequential animation\n  enter_grow() +                     # Pins grow as they appear\n  exit_fade() +                      # Optional: Pins fade out\n  theme_minimal()\n\n# Step 5: Render and Save the Animation ----------------------------------------\n# animate(animated_map, nframes = 50, fps = 2, width = 600, height = 400, renderer = gifski_renderer())\n\n# anim_save(\"nyc_high_density_animation.gif\")\n# \n# knitr::include_graphics(\"nyc_high_density_animation.gif\")\n\n\n #### Key Observations Across Boroughs:\n\nBronx:\n\nThe ZIP codes 10457 and 10458 show higher rat density (above 12,000) while also exhibiting a significant number of restaurants with Grade B and C.\nThere seems to be a noticeable link between the increase in rat activity and areas with more restaurants receiving lower grades.\n\nBrooklyn:\n\nZIP codes 11215 and 11222 show the highest rat densities (over 20,000), corresponding to relatively high numbers of restaurants with Grade B and C.\nRat infestations in Brooklyn appear to cluster in specific ZIP codes, suggesting that localized waste management issues may be contributing to the problem.\n\nManhattan:\n\nZIP codes 10013 and 10036 have both the highest number of restaurants with Grade B and C (over 600) and noticeable rat activity.\nDespite a significant concentration of lower-graded restaurants, rat densities remain moderate compared to other boroughs, suggesting more effective urban management in some areas.\n\nQueens:\n\nZIP codes 11385 and 11373 show the highest rat densities and a considerable number of restaurants with Grade B and C.\nRat density appears to peak sharply in specific ZIP codes, correlating with localized concentrations of lower-graded restaurants.\n\nStaten Island:\n\nStaten Island has the lowest rat  across all ZIP codes, with a small number of lower-graded restaurants.\nZIP code 10301 has the highest rat density (600) but relatively fewer restaurants compared to other boroughs.\n\n\n\n\n\n\nLocalized Rat Clusters:\n\nRat density is not uniformly distributed; specific ZIP codes within boroughs, such as 10457 (Bronx) and 11215 (Brooklyn), experience disproportionately high rat activity.\n\nBorough-Specific Trends:\n\nManhattan: Despite high restaurant density, rat activity remains moderate.\nBrooklyn and Bronx: Exhibit stronger correlations between rat density and restaurants with lower grades.\nStaten Island: Shows consistently lower rat activity, indicating better overall sanitation.\n\nTargeted Interventions:\n\nZIP codes with high numbers of Grade B and C restaurants should be prioritized for sanitation inspections and waste management improvements to reduce rat activity.\n\n\n\n\n\nThe analysis highlights a positive relationship between the number of restaurants with lower grades (B and C) and rat activity density, especially in high-density boroughs like the Bronx, Brooklyn, and Queens. Effective sanitation practices and targeted interventions in identified ZIP codes are critical to addressing this issue.\n\n\n\n\n\nOutdoor dining in New York City became a significant part of the restaurant scene, particularly during the COVID-19 pandemic, when it was rapidly expanded to allow restaurants to operate on sidewalks, streets, and other open spaces. While this initiative provided safer dining options and supported businesses, it also brought challenges related to sanitation and waste management. Food scraps, improperly stored trash, and debris from outdoor setups created an environment that attracted pests, particularly rats, leading to increased health code violations and rat sightings.\nTo analyze if outdoor dining has caused an increase in rat infestations, we will compare rat sightings near outdoor dining violations over time. By identifying outdoor seating violations and checking for rat inspections within a 100-meter radius, we can observe patterns and trends. Specifically, we will focus on the pandemic years (2020-2022) when outdoor dining expanded significantly, to determine if rat infestation rates increased in these areas compared to previous years.\n\n\n\nThe increase in outdoor seating violations after COVID (2020-2022) may have contributed to higher rat infestation rates. This could be due to improper waste management and sanitation practices around outdoor dining areas.\n\n\n\nshow the code\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(geosphere)\nlibrary(lubridate)\n\n\n# Filter rat inspections with valid lat/lon and failed results\nrats_filtered_loc &lt;- rats_filtered_data %&gt;%\n  filter(!is.na(LATITUDE) & !is.na(LONGITUDE) & RESULT != \"Passed\") %&gt;%\n  mutate(YEAR = year(mdy_hms(INSPECTION_DATE)))\n\n# Extract outdoor seating violations from restaurants\noutdoor_seating &lt;- restaurant_filtered_data %&gt;%\n  filter(grepl(\"outdoor|seating|sidewalk\", `VIOLATION DESCRIPTION`, ignore.case = TRUE)) %&gt;%\n  filter(!is.na(Latitude) & !is.na(Longitude)) %&gt;%\n  mutate(YEAR = year(mdy(`INSPECTION DATE`)))\n\n# Select coordinates for rats and outdoor seating\noutdoor_coords &lt;- outdoor_seating %&gt;% \n  select(Latitude, Longitude) %&gt;% \n  filter(!is.na(Latitude) & !is.na(Longitude)) %&gt;%\n  na.omit()\n\nrat_coords &lt;- rats_filtered_loc %&gt;% \n  select(LATITUDE, LONGITUDE) %&gt;%\n  filter(!is.na(LATITUDE) & !is.na(LONGITUDE)) %&gt;%\n  na.omit()\n\n# Function to check for nearby rats (100 meters)\nfind_rats_nearby &lt;- function(outdoor_coords, rat_coords, distance_threshold = 100) {\n  # Ensure both inputs are matrices with exactly two columns\n  rat_coords &lt;- as.matrix(rat_coords[, c(1, 2)])\n  outdoor_coords &lt;- as.matrix(outdoor_coords[, c(1, 2)])\n  \n  # Validate column names and types\n  if (ncol(rat_coords) != 2 | ncol(outdoor_coords) != 2) {\n    stop(\"Error: Inputs must have exactly two columns (latitude, longitude).\")\n  }\n  \n  result &lt;- sapply(1:nrow(outdoor_coords), function(i) {\n    point &lt;- outdoor_coords[i, ]  # Current restaurant coordinates\n    distances &lt;- distHaversine(matrix(point, nrow = 1), rat_coords)  # Distance to all rat points\n    any(distances &lt;= distance_threshold)  # TRUE if within threshold\n  })\n  return(result)\n}\n\n# Apply the corrected function\noutdoor_seating$RAT_INFESTATION_NEARBY &lt;- find_rats_nearby(outdoor_coords, rat_coords)\n\n\n# Select specific columns\nselected_columns &lt;- outdoor_seating %&gt;%\n  select(\"DBA\",\"BORO\",\"ZIPCODE\", \"YEAR\",`VIOLATION CODE`, 'RAT_INFESTATION_NEARBY')\n\n# Print the selected columns\nkable(head(selected_columns, 6))\n\n\n\n\n\n\n\n\n\n\n\n\n\nDBA\nBORO\nZIPCODE\nYEAR\nVIOLATION CODE\nRAT_INFESTATION_NEARBY\n\n\n\n\nBLUESTONE LANE\nManhattan\n10128\n2024\n28-07\nTRUE\n\n\nSTEVE’S ORIGINAL JERK CHICKEN\nBrooklyn\n11203\n2022\n28-07\nTRUE\n\n\nG & S RESTAURANT\nBronx\n10466\n2024\n28-07\nTRUE\n\n\nTWO BROTHERS FISH & CHIPS\nBrooklyn\n11206\n2023\n28-07\nTRUE\n\n\nZOUJI BBQ\nQueens\n11355\n2024\n28-07\nTRUE\n\n\nNIEVES TIA MIMI ICES\nBrooklyn\n11220\n2024\n28-07\nTRUE\n\n\n\n\n\nshow the code\n# Group by year and count rat infestations near outdoor seating violations\nrat_summary &lt;- outdoor_seating %&gt;%\n  filter(RAT_INFESTATION_NEARBY == TRUE) %&gt;%\n  group_by(YEAR) %&gt;%\n  summarise(Rat_Infestations = n())\n\n# Summarize total outdoor seating violations by year\noutdoor_summary &lt;- outdoor_seating %&gt;%\n  group_by(YEAR) %&gt;%\n  summarise(Outdoor_Violations = n())\n\n# Combine the two summaries\ncombined_summary &lt;- full_join(outdoor_summary, rat_summary, by = \"YEAR\") %&gt;%\n  replace_na(list(Outdoor_Violations = 0, Rat_Infestations = 0))\n\n# Visualization --------------------------------------------------------------\nggplot(combined_summary, aes(x = YEAR)) +\n  geom_bar(aes(y = Outdoor_Violations, fill = \"Outdoor Violations\"), \n           stat = \"identity\", position = \"dodge\") +\n  geom_line(aes(y = Rat_Infestations, color = \"Rat Infestations\"), size = 1) +\n  scale_fill_manual(values = c(\"Outdoor Violations\" = \"steelblue\")) +\n  scale_color_manual(values = c(\"Rat Infestations\" = \"red\")) +\n  geom_rect(aes(xmin = 2020, xmax = 2022, ymin = 0, ymax = Inf), \n            fill = \"gray\", alpha = 0.2) +\n  labs(title = \"Impact of Outdoor Seating on Rat Infestation Rates\",\n       subtitle = \"Highlighted COVID Period (2020-2022)\",\n       x = \"Year\", y = \"Count\",\n       fill = \"Legend\", color = \"Legend\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\nOutdoor Violations:\n\nThere was a clear increase in outdoor seating violations after 2022.\nThe violations appear to be highest in 2024, following a gradual rise from 2022 to 2024.\n\nRat Infestation Rates:\n\nRat infestations near outdoor seating violations also showed a consistent upward trend, increasing sharply in 2023 and 2024.\nThe correlation suggests that as outdoor seating violations increase, rat infestations also rise.\n\nCOVID Period (2020-2022):\n\nThe shaded gray area highlights the COVID period (2020-2022), where the counts of outdoor seating violations and rat infestations were relatively lower compared to post-COVID years.\nPost-2022, there is a notable rise in both outdoor violations and rat infestations.\n\n\n\n\n\n(Relevant article)\nA report by Elazar Sontag in Eater (December 14, 2021) provides critical insights into the rise of rat infestations in New York City post-COVID-19, aligning with my findings on the impact of outdoor dining. The article shares a specific incident at a Brooklyn wine bar where an unusual smell was traced to something decaying beneath the outdoor dining structure, inaccessible without tearing up the entire parklet. This story highlights how outdoor dining setups, while beneficial for restaurants, inadvertently created new habitats for rats by providing shelter and easier access to food waste.\nI think we can all agree that during the peak of COVID-19 in 2020, rat populations initially declined due to the closure of restaurants, which limited food availability. Sontag’s article describes reports of starving rats resorting to cannibalism as food sources dwindled. However, the reopening of restaurants, particularly with outdoor dining spaces and street-side cooking, reversed this trend by creating an abundance of food once again. As a result, rats rapidly reappeared, with infestations increasing across neighborhoods.\nThis finding aligns with my analysis, which shows a notable correlation between rat activity and outdoor dining violations post-COVID. The lack of adequate waste management in outdoor setups further exacerbated the problem, leading to lawsuits demanding stricter sanitation measures and reconsideration of outdoor dining practices. The issue is not unique to NYC; cities like New Orleans, Chicago, and Los Angeles have reported unprecedented increases in rat sightings following the rise of outdoor dining. These observations emphasize the need for improved waste management strategies to address the unintended consequences of outdoor dining on urban rat infestations.\n\n\n\n\nPost-COVID: The rise/ existing in unauthorized outdoor dining, lack of proper waste management, street cooking, and similar activities have likely exacerbated rat infestations, emphasizing the importance of effective waste management.\nPreventative Measures: To mitigate rat infestations, stricter enforcement of sanitation protocols for outdoor seating areas is necessary, especially in periods of increased outdoor dining activity.\n\n\n\n\nWe can see a positive relationship between the increase in outdoor seating violations and rat infestation, particularly in 2024.\n\n\n\n\n\nRestaurants are a key part of NYC’s culture and economy, providing jobs, tourism, and vibrant dining spaces. However, poor sanitation and the rise of outdoor dining have contributed to rat infestations by increasing food waste and trash.\nNow, we will analyze the correlation between restaurant density and rat population across NYC boroughs. Higher restaurant density, especially those with poor grades (B and C), may attract and sustain larger rat populations, highlighting the connection between restaurant presence and rat infestations in NYC.\n\n\n\nHigher restaurant density contributes to increased rat activity due to improper waste management, food availability, and urban environmental factors.\n\n\n\nshow the code\n# Step 1: Prepare ZIP Code Mapping -------------------------------------------\nzipcode_mapping &lt;- zipcode_mapping %&gt;%\n  mutate(ZIPCODE = str_trim(as.character(Zipcode)),\n         BOROUGH = str_trim(as.character(Borough)))\n\n# Step 2: Fill NA or Invalid BORO in Restaurant Data -------------------------\nrestaurant_filtered_zb &lt;- restaurant_filtered_data %&gt;%\n  mutate(ZIPCODE = str_trim(as.character(ZIPCODE)),  # Trim and convert ZIPCODE\n         BORO = ifelse(is.na(BORO) | BORO == \"0\", \n                       coalesce(zipcode_mapping$BOROUGH[match(ZIPCODE, zipcode_mapping$ZIPCODE)], BORO),\n                       BORO))\n\n# Step 3: Fill NA or Invalid BOROUGH in Rat Data -----------------------------\nrats_filtered_zb &lt;- rats_filtered_data %&gt;%\n  mutate(ZIP_CODE = str_trim(as.character(ZIP_CODE)),  # Trim and convert ZIP_CODE\n         BOROUGH = coalesce(zipcode_mapping$BOROUGH[match(ZIP_CODE, zipcode_mapping$ZIPCODE)], BOROUGH))\n\n\n# Step 2: Filter Rat Data for Rat Activity -----------------------------------\nrat_activity &lt;- rats_filtered_zb %&gt;%\n  filter(!RESULT %in% c(\"Passed\", \"Failed for Other R\")) %&gt;%\n  filter(!is.na(LATITUDE) & !is.na(LONGITUDE)) %&gt;%\n  group_by(BOROUGH) %&gt;%\n  summarise(Rat_Activity_Count = n())\n\n# Step 3: Aggregate Restaurant Data by Borough ------------------------------\nrestaurant_density &lt;- restaurant_filtered_zb %&gt;%\n  filter(!is.na(Latitude) & !is.na(Longitude)) %&gt;%\n  group_by(BORO) %&gt;%\n  summarise(Restaurant_Count = n())\n\n# Step 4: Merge Data ---------------------------------------------------------\ndensity_data &lt;- restaurant_density %&gt;%\n  mutate(BORO = str_to_lower(str_trim(BORO))) %&gt;%\n  inner_join(\n    rat_activity %&gt;%\n      mutate(BOROUGH = str_to_lower(str_trim(BOROUGH))),\n    by = c(\"BORO\" = \"BOROUGH\")\n  )\n\n# Step 5: Visualization ------------------------------------------------------\n\nggplot(density_data, aes(x = Restaurant_Count, y = Rat_Activity_Count, label = BORO)) +\n  geom_point(size = 4, color = \"blue\") +                               # Scatter points\n  geom_smooth(method = \"lm\", color = \"red\", se = TRUE) +               # Trendline with confidence interval\n  geom_text_repel(aes(label = paste0(BORO, \" (\", Restaurant_Count, \", \", Rat_Activity_Count, \")\")),\n                  size = 4, color = \"black\", box.padding = 0.5) +      # Add BORO and coordinates\n  scale_y_continuous(labels = comma) +                                 # Format y-axis as whole numbers\n  scale_x_continuous(labels = comma) +                                 # Format x-axis as whole numbers\n  labs(title = \"Density of Restaurants vs Rat Activity\",\n       subtitle = \"Analyzing Relationship Between Restaurants and Rat Infestation Rates\",\n       x = \"Number of Restaurants (Density)\",\n       y = \"Number of Rat Activity Inspections\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\nPositive Correlation:\n\nThe graph shows a slight positive correlation between the number of restaurants (restaurant density) and the number of rat activity inspections.\nBoroughs with higher restaurant density, such as Manhattan and Brooklyn, also exhibit higher rat activity inspections.\n\nManhattan and Brooklyn:\n\nThese boroughs have the highest restaurant densities (e.g., Manhattan: ~94,661 restaurants) and significant rat activity counts (e.g., 136,963 inspections).\nThis suggests that areas with concentrated restaurant activity may experience increased rat infestations due to factors such as waste generation.\n\nLow-Density Areas:\n\nStaten Island has the lowest restaurant density (~9,218 restaurants) and rat activity inspections (~2,049). This aligns with the general trend that lower restaurant density areas tend to have lower rat activity.\n\nOutliers:\n\nThe Bronx appears to have a higher number of rat activity inspections relative to its restaurant density (~23,274 restaurants, ~96,498 inspections). This could indicate other contributing factors, such as waste management issues or urban infrastructure challenges.\n\n\n\n\n\n\nTargeted Waste Management Policies: Boroughs with higher restaurant density, like Manhattan and Brooklyn, require stricter waste management practices to mitigate rat infestations.\nFurther Investigation: The Bronx’s higher rat activity relative to restaurant density warrants further analysis into non-restaurant-related factors contributing to infestations.\n\n\n\n\n\n\nOur analysis demonstrates a clear relationship between rat infestations in NYC and factors such as poor sanitation, restaurant density, and the expansion of outdoor dining. We found that areas with higher concentrations of restaurants, particularly those with grades B and C, tend to experience increased rat activity. Poor waste management, exacerbated by outdoor dining setups, creates conditions that attract and sustain rat populations. Boroughs like Manhattan and Brooklyn, with the highest restaurant density, showed the strongest correlation with rat infestations.\n\n\n\n\nData Quality: Our analysis relies on inspection data, which may not capture all instances of rat activity or sanitation violations. Underreporting or delayed reporting could affect the results.\nSpatial Accuracy: We assume a 100-meter radius for rat sightings around outdoor dining violations, which may not accurately reflect rats’ mobility or the true impact area.\nCausality vs. Correlation: While we found correlations between restaurant density, sanitation, and rat activity, this does not prove direct causality. Other\nunderlying factors might contribute to the observed patterns.\nCOVID-19 Impact: The unique circumstances of the COVID-19 pandemic, such as temporary outdoor dining policies and changes in waste management services, could distort long-term trends.\n\n\n\n\n\nOur analysis has revealed significant correlations between poor restaurant grades (B and C), rat activity, restaurant density, and the impact of outdoor dining on rat infestations across NYC neighborhoods. While these findings provide important insights, further work is needed to deepen our understanding and address limitations. Below are key proposals for future work:\n\nBorough-Level and Neighborhood-Specific Analysis\n\nConduct a detailed analysis at the borough and neighborhood levels to identify localized trends and specific hotspots. This will help target interventions in areas with the highest rat activity and poor restaurant sanitation.\n\nComparison with Other Cities\n\nConduct a comparative analysis with data from other major cities to understand how NYC’s rat infestation problem aligns with or differs from similar urban areas. This can offer best practices for managing sanitation and rat control.\n\nPublic Behavior and Policy Impact\n\nAssess the role of public behavior (e.g., littering, improper waste disposal) and evaluate the effectiveness of existing sanitation policies. Surveys or community-level data can provide insights into how public education campaigns and enforcement influence rat activity.\n\nTemporal Trends and Longitudinal Analysis\n\nExpand the analysis to include multi-year data to examine how rat activity changes over time, particularly before, during, and after the COVID-19 pandemic. Investigating seasonal trends will also help determine when rat infestations peak and how outdoor dining contributes to this cycle."
  },
  {
    "objectID": "individual_report.html#correlation-between-poor-restaurant-sanitation-and-increased-rat-activity",
    "href": "individual_report.html#correlation-between-poor-restaurant-sanitation-and-increased-rat-activity",
    "title": "Final Individual Report",
    "section": "",
    "text": "Boroughs with a higher number of Grade B and C restaurants are more likely to experience elevated rat sighting, particularly in localized ZIP codes. Poor sanitation practices associated with lower restaurant grades likely contribute to rat infestations.\n\nTo address the limitations of missing data and analyze the relationship between poor restaurant sanitation and rat activity, we focused on restaurants with Grades B and C and rat density across ZIP Codes in the five boroughs of New York City: Bronx, Brooklyn, Manhattan, Queens, and Staten Island.\nData Cleaning and Standardization\n\nZIP Code Validation: The data was cleaned and standardized to ensure all ZIP Codes were valid and accurately mapped to their respective boroughs using a ZIP\nCode-to-borough mapping file.\nRestaurant Sanitation Data:\nRestaurants receiving sanitation Grades B and C, which indicate lower sanitation standards, were filtered and counted for each ZIP Code.\nRat Density Data: Rat activity data was filtered to exclude inspections resulting in “Passed” or “Failed for Other R” outcomes. This provided a more\nreliable measure of rat activity by focusing on confirmed rodent sightings or infestations.\n\nMerging and Analysis\nThe cleaned restaurant sanitation data and rat density data were merged using ZIP Codes as the key. This integration allowed us to directly compare the number of restaurants with lower sanitation grades to rat activity within each ZIP Code.\nThis process ensured a comprehensive analysis of how poor sanitation practices in restaurants might correlate with increased rat infestations across New York City neighborhoods.\n\n\nshow the code\n# Step 1: Clean ZIP Codes and Map Boroughs -----------------------------------\nzipcode_mapping &lt;- zipcode_mapping %&gt;%\n  mutate(ZIPCODE = str_trim(as.character(Zipcode)),\n         BOROUGH = str_trim(as.character(Borough)))\n\n# Clean and map restaurant data\nrestaurants_clean &lt;- restaurant_filtered_data %&gt;%\n  mutate(ZIPCODE = str_trim(as.character(ZIPCODE)),\n         ZIPCODE = ifelse(str_length(ZIPCODE) == 5, ZIPCODE, NA)) %&gt;%  # Ensure valid 5-digit ZIP codes\n  filter(!is.na(ZIPCODE)) %&gt;%\n  mutate(BORO = ifelse(is.na(BORO), \n                       zipcode_mapping$BOROUGH[match(ZIPCODE, zipcode_mapping$ZIPCODE)], \n                       BORO))\n\n# Filter for restaurants with Grades B and C\nrestaurants_bc &lt;- restaurants_clean %&gt;%\n  filter(GRADE %in% c(\"B\", \"C\")) %&gt;%\n  group_by(BORO, ZIPCODE) %&gt;%\n  summarise(Restaurants_Grade_BC = n(), .groups = \"drop\")\n\n# Clean and map rat data\nrats_clean &lt;- rats_filtered_data %&gt;%\n  mutate(ZIP_CODE = str_trim(as.character(ZIP_CODE)),\n         ZIP_CODE = ifelse(str_length(ZIP_CODE) == 5, ZIP_CODE, NA)) %&gt;%\n  filter(!is.na(ZIP_CODE), !RESULT %in% c(\"Passed\", \"Failed for Other R\")) %&gt;%\n  mutate(BOROUGH = ifelse(is.na(BOROUGH), \n                          zipcode_mapping$BOROUGH[match(ZIP_CODE, zipcode_mapping$ZIPCODE)], \n                          BOROUGH)) %&gt;%\n  group_by(BOROUGH, ZIP_CODE) %&gt;%\n  summarise(Rat_Density = n(), .groups = \"drop\")\n\n# Step 2: Combine Data -------------------------------------------------------\ncombined_data &lt;- full_join(restaurants_bc, rats_clean, \n                           by = c(\"ZIPCODE\" = \"ZIP_CODE\", \"BORO\" = \"BOROUGH\")) %&gt;%\n  replace_na(list(Restaurants_Grade_BC = 0, Rat_Density = 0))\n\nkable(head(combined_data, 5))\n\n\n\n\n\nBORO\nZIPCODE\nRestaurants_Grade_BC\nRat_Density\n\n\n\n\nBronx\n10451\n103\n4515\n\n\nBronx\n10452\n105\n9205\n\n\nBronx\n10453\n93\n7843\n\n\nBronx\n10454\n91\n1907\n\n\nBronx\n10455\n132\n3159\n\n\n\n\n\nshow the code\n# Step 3: Generate Plots for Each Borough ------------------------------------\nplot_list &lt;- list()\n\nboroughs &lt;- unique(combined_data$BORO)\n\n# Loop through each borough and create plots\nfor (b in boroughs) {\n  data_borough &lt;- combined_data %&gt;% filter(BORO == b)\n  \n  # Plot 1: Number of Restaurants (Grade B and C) by ZIP Code\n  plot_bc &lt;- ggplot(data_borough, aes(x = ZIPCODE, y = Restaurants_Grade_BC, group = 1)) +\n    geom_line(color = \"blue\", size = 1) +\n    geom_point(color = \"blue\", size = 2) +\n    labs(title = paste(\"Number of Restaurants with Grade B and C -\", b),\n         x = \"ZIP Code\", y = \"Number of Restaurants\") +\n    theme_minimal() +\n    theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 10),\n          plot.title = element_text(size = 12, face = \"bold\")) +\n    scale_y_continuous(labels = comma)\n  \n  # Plot 2: Rat Density by ZIP Code\n  plot_rats &lt;- ggplot(data_borough, aes(x = ZIPCODE, y = Rat_Density, group = 1)) +\n    geom_line(color = \"red\", size = 1) +\n    geom_point(color = \"red\", size = 2) +\n    labs(title = paste(\"Rat Sighting per ZIP Code -\", b),\n         x = \"ZIP Code\", y = \"Rat Sighting\") +\n    theme_minimal() +\n    theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 10),\n          plot.title = element_text(size = 12, face = \"bold\")) +\n    scale_y_continuous(labels = comma)\n  \n  # Arrange the two plots vertically (one on top of the other)\n  combined_plot &lt;- grid.arrange(plot_bc, plot_rats, ncol = 1)  # Use ncol = 1 for vertical layout\n  plot_list[[b]] &lt;- combined_plot\n  \n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nshow the code\noptions(tigris_progress = FALSE)\n\n\nlibrary(tigris)     # Fetch borough boundaries\nlibrary(sf)         # Spatial data\nlibrary(dplyr)      # Data manipulation\nlibrary(ggplot2)    # Visualization\nlibrary(ggrepel)    # Improved text labels\nlibrary(zipcodeR)   # st want to Fetch latitude/longitude for ZIP codes\nlibrary(gganimate)  # Animation\n#options(gganimate.dev = gifski_renderer())\nlibrary(transformr) # Smooth animations\nlibrary(gifski)\nlibrary(av)\n\n\n# Step 1: Fetch NYC Borough Boundaries -----------------------------------------\nnyc_boroughs &lt;- counties(state = \"NY\", cb = TRUE, resolution = \"5m\", year = 2022) %&gt;%\n  filter(NAME %in% c(\"Bronx\", \"Kings\", \"New York\", \"Queens\", \"Richmond\")) # NYC counties\n\n# Calculate centroid of each borough for annotation\nborough_centroids &lt;- nyc_boroughs %&gt;%\n  st_centroid() %&gt;%\n  st_coordinates() %&gt;%\n  as.data.frame() %&gt;%\n  bind_cols(Borough = nyc_boroughs$NAME)\n\n# Step 2: Filter High-Density Data ---------------------------------------------\n# Filter for areas with high restaurant density and rat population\nhigh_density_data &lt;- combined_data %&gt;%\n  filter(Restaurants_Grade_BC &gt; 100 & Rat_Density &gt; 500)\n\n# Step 3: Add Coordinates to ZIP Codes -----------------------------------------\n# Fetch latitude and longitude for ZIP codes using zipcodeR\nhigh_density_data &lt;- high_density_data %&gt;%\n  mutate(coords = purrr::map(ZIPCODE, reverse_zipcode)) %&gt;%\n  tidyr::unnest_wider(coords) %&gt;% \n  filter(!is.na(lat) & !is.na(lng)) %&gt;% # Ensure valid coordinates\n  rename(Longitude = lng, Latitude = lat) %&gt;%\n  arrange(BORO, ZIPCODE) %&gt;%  # Arrange for animation\n  mutate(step = row_number()) # Add animation sequence\n\n# Update borough names\nborough_centroids &lt;- borough_centroids %&gt;%\n  mutate(Borough = case_when(\n    Borough == \"New York\" ~ \"Manhattan\",\n    Borough == \"Kings\" ~ \"Brooklyn\",\n    Borough == \"Richmond\" ~ \"Staten Island\",\n    TRUE ~ Borough\n  ))\n\n# Step 4: Create the Animated Map with Borough Annotations ---------------------\nanimated_map &lt;- ggplot() +\n  # Plot borough boundaries\n  geom_sf(data = nyc_boroughs, fill = \"lightgray\", color = \"white\") +\n  \n  # Add borough names at centroid positions\n  geom_text(data = borough_centroids, \n            aes(x = X, y = Y, label = Borough), \n            color = \"black\", size = 5, fontface = \"bold\") +\n\n  # Add animated pins for high-density areas\n  geom_point(data = high_density_data, \n             aes(x = Longitude, y = Latitude, group = step), \n             color = \"red\", size = 3) +\n  \n  # Add ZIP Code labels\n  geom_text_repel(data = high_density_data, \n                  aes(x = Longitude, y = Latitude, label = ZIPCODE), \n                  size = 3) +\n  \n  # Titles and captions\n  labs(title = \"High-Density Restaurant and Rat Population Areas in NYC\",\n       subtitle = \"Sequential display of ZIP Codes with high density\",\n       caption = \"Data Source: NYC Open Data & tigris\") +\n  \n  # Animation\n  transition_reveal(along = step) +  # Sequential animation\n  enter_grow() +                     # Pins grow as they appear\n  exit_fade() +                      # Optional: Pins fade out\n  theme_minimal()\n\n# Step 5: Render and Save the Animation ----------------------------------------\n# animate(animated_map, nframes = 50, fps = 2, width = 600, height = 400, renderer = gifski_renderer())\n\n# anim_save(\"nyc_high_density_animation.gif\")\n# \n# knitr::include_graphics(\"nyc_high_density_animation.gif\")\n\n\n #### Key Observations Across Boroughs:\n\nBronx:\n\nThe ZIP codes 10457 and 10458 show higher rat density (above 12,000) while also exhibiting a significant number of restaurants with Grade B and C.\nThere seems to be a noticeable link between the increase in rat activity and areas with more restaurants receiving lower grades.\n\nBrooklyn:\n\nZIP codes 11215 and 11222 show the highest rat densities (over 20,000), corresponding to relatively high numbers of restaurants with Grade B and C.\nRat infestations in Brooklyn appear to cluster in specific ZIP codes, suggesting that localized waste management issues may be contributing to the problem.\n\nManhattan:\n\nZIP codes 10013 and 10036 have both the highest number of restaurants with Grade B and C (over 600) and noticeable rat activity.\nDespite a significant concentration of lower-graded restaurants, rat densities remain moderate compared to other boroughs, suggesting more effective urban management in some areas.\n\nQueens:\n\nZIP codes 11385 and 11373 show the highest rat densities and a considerable number of restaurants with Grade B and C.\nRat density appears to peak sharply in specific ZIP codes, correlating with localized concentrations of lower-graded restaurants.\n\nStaten Island:\n\nStaten Island has the lowest rat  across all ZIP codes, with a small number of lower-graded restaurants.\nZIP code 10301 has the highest rat density (600) but relatively fewer restaurants compared to other boroughs.\n\n\n\n\n\n\nLocalized Rat Clusters:\n\nRat density is not uniformly distributed; specific ZIP codes within boroughs, such as 10457 (Bronx) and 11215 (Brooklyn), experience disproportionately high rat activity.\n\nBorough-Specific Trends:\n\nManhattan: Despite high restaurant density, rat activity remains moderate.\nBrooklyn and Bronx: Exhibit stronger correlations between rat density and restaurants with lower grades.\nStaten Island: Shows consistently lower rat activity, indicating better overall sanitation.\n\nTargeted Interventions:\n\nZIP codes with high numbers of Grade B and C restaurants should be prioritized for sanitation inspections and waste management improvements to reduce rat activity.\n\n\n\n\n\nThe analysis highlights a positive relationship between the number of restaurants with lower grades (B and C) and rat activity density, especially in high-density boroughs like the Bronx, Brooklyn, and Queens. Effective sanitation practices and targeted interventions in identified ZIP codes are critical to addressing this issue."
  },
  {
    "objectID": "individual_report.html#outdoor-dining-and-its-impact-on-rat-infestation-in-nyc",
    "href": "individual_report.html#outdoor-dining-and-its-impact-on-rat-infestation-in-nyc",
    "title": "Final Individual Report",
    "section": "",
    "text": "Outdoor dining in New York City became a significant part of the restaurant scene, particularly during the COVID-19 pandemic, when it was rapidly expanded to allow restaurants to operate on sidewalks, streets, and other open spaces. While this initiative provided safer dining options and supported businesses, it also brought challenges related to sanitation and waste management. Food scraps, improperly stored trash, and debris from outdoor setups created an environment that attracted pests, particularly rats, leading to increased health code violations and rat sightings.\nTo analyze if outdoor dining has caused an increase in rat infestations, we will compare rat sightings near outdoor dining violations over time. By identifying outdoor seating violations and checking for rat inspections within a 100-meter radius, we can observe patterns and trends. Specifically, we will focus on the pandemic years (2020-2022) when outdoor dining expanded significantly, to determine if rat infestation rates increased in these areas compared to previous years.\n\n\n\nThe increase in outdoor seating violations after COVID (2020-2022) may have contributed to higher rat infestation rates. This could be due to improper waste management and sanitation practices around outdoor dining areas.\n\n\n\nshow the code\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(geosphere)\nlibrary(lubridate)\n\n\n# Filter rat inspections with valid lat/lon and failed results\nrats_filtered_loc &lt;- rats_filtered_data %&gt;%\n  filter(!is.na(LATITUDE) & !is.na(LONGITUDE) & RESULT != \"Passed\") %&gt;%\n  mutate(YEAR = year(mdy_hms(INSPECTION_DATE)))\n\n# Extract outdoor seating violations from restaurants\noutdoor_seating &lt;- restaurant_filtered_data %&gt;%\n  filter(grepl(\"outdoor|seating|sidewalk\", `VIOLATION DESCRIPTION`, ignore.case = TRUE)) %&gt;%\n  filter(!is.na(Latitude) & !is.na(Longitude)) %&gt;%\n  mutate(YEAR = year(mdy(`INSPECTION DATE`)))\n\n# Select coordinates for rats and outdoor seating\noutdoor_coords &lt;- outdoor_seating %&gt;% \n  select(Latitude, Longitude) %&gt;% \n  filter(!is.na(Latitude) & !is.na(Longitude)) %&gt;%\n  na.omit()\n\nrat_coords &lt;- rats_filtered_loc %&gt;% \n  select(LATITUDE, LONGITUDE) %&gt;%\n  filter(!is.na(LATITUDE) & !is.na(LONGITUDE)) %&gt;%\n  na.omit()\n\n# Function to check for nearby rats (100 meters)\nfind_rats_nearby &lt;- function(outdoor_coords, rat_coords, distance_threshold = 100) {\n  # Ensure both inputs are matrices with exactly two columns\n  rat_coords &lt;- as.matrix(rat_coords[, c(1, 2)])\n  outdoor_coords &lt;- as.matrix(outdoor_coords[, c(1, 2)])\n  \n  # Validate column names and types\n  if (ncol(rat_coords) != 2 | ncol(outdoor_coords) != 2) {\n    stop(\"Error: Inputs must have exactly two columns (latitude, longitude).\")\n  }\n  \n  result &lt;- sapply(1:nrow(outdoor_coords), function(i) {\n    point &lt;- outdoor_coords[i, ]  # Current restaurant coordinates\n    distances &lt;- distHaversine(matrix(point, nrow = 1), rat_coords)  # Distance to all rat points\n    any(distances &lt;= distance_threshold)  # TRUE if within threshold\n  })\n  return(result)\n}\n\n# Apply the corrected function\noutdoor_seating$RAT_INFESTATION_NEARBY &lt;- find_rats_nearby(outdoor_coords, rat_coords)\n\n\n# Select specific columns\nselected_columns &lt;- outdoor_seating %&gt;%\n  select(\"DBA\",\"BORO\",\"ZIPCODE\", \"YEAR\",`VIOLATION CODE`, 'RAT_INFESTATION_NEARBY')\n\n# Print the selected columns\nkable(head(selected_columns, 6))\n\n\n\n\n\n\n\n\n\n\n\n\n\nDBA\nBORO\nZIPCODE\nYEAR\nVIOLATION CODE\nRAT_INFESTATION_NEARBY\n\n\n\n\nBLUESTONE LANE\nManhattan\n10128\n2024\n28-07\nTRUE\n\n\nSTEVE’S ORIGINAL JERK CHICKEN\nBrooklyn\n11203\n2022\n28-07\nTRUE\n\n\nG & S RESTAURANT\nBronx\n10466\n2024\n28-07\nTRUE\n\n\nTWO BROTHERS FISH & CHIPS\nBrooklyn\n11206\n2023\n28-07\nTRUE\n\n\nZOUJI BBQ\nQueens\n11355\n2024\n28-07\nTRUE\n\n\nNIEVES TIA MIMI ICES\nBrooklyn\n11220\n2024\n28-07\nTRUE\n\n\n\n\n\nshow the code\n# Group by year and count rat infestations near outdoor seating violations\nrat_summary &lt;- outdoor_seating %&gt;%\n  filter(RAT_INFESTATION_NEARBY == TRUE) %&gt;%\n  group_by(YEAR) %&gt;%\n  summarise(Rat_Infestations = n())\n\n# Summarize total outdoor seating violations by year\noutdoor_summary &lt;- outdoor_seating %&gt;%\n  group_by(YEAR) %&gt;%\n  summarise(Outdoor_Violations = n())\n\n# Combine the two summaries\ncombined_summary &lt;- full_join(outdoor_summary, rat_summary, by = \"YEAR\") %&gt;%\n  replace_na(list(Outdoor_Violations = 0, Rat_Infestations = 0))\n\n# Visualization --------------------------------------------------------------\nggplot(combined_summary, aes(x = YEAR)) +\n  geom_bar(aes(y = Outdoor_Violations, fill = \"Outdoor Violations\"), \n           stat = \"identity\", position = \"dodge\") +\n  geom_line(aes(y = Rat_Infestations, color = \"Rat Infestations\"), size = 1) +\n  scale_fill_manual(values = c(\"Outdoor Violations\" = \"steelblue\")) +\n  scale_color_manual(values = c(\"Rat Infestations\" = \"red\")) +\n  geom_rect(aes(xmin = 2020, xmax = 2022, ymin = 0, ymax = Inf), \n            fill = \"gray\", alpha = 0.2) +\n  labs(title = \"Impact of Outdoor Seating on Rat Infestation Rates\",\n       subtitle = \"Highlighted COVID Period (2020-2022)\",\n       x = \"Year\", y = \"Count\",\n       fill = \"Legend\", color = \"Legend\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\nOutdoor Violations:\n\nThere was a clear increase in outdoor seating violations after 2022.\nThe violations appear to be highest in 2024, following a gradual rise from 2022 to 2024.\n\nRat Infestation Rates:\n\nRat infestations near outdoor seating violations also showed a consistent upward trend, increasing sharply in 2023 and 2024.\nThe correlation suggests that as outdoor seating violations increase, rat infestations also rise.\n\nCOVID Period (2020-2022):\n\nThe shaded gray area highlights the COVID period (2020-2022), where the counts of outdoor seating violations and rat infestations were relatively lower compared to post-COVID years.\nPost-2022, there is a notable rise in both outdoor violations and rat infestations.\n\n\n\n\n\n(Relevant article)\nA report by Elazar Sontag in Eater (December 14, 2021) provides critical insights into the rise of rat infestations in New York City post-COVID-19, aligning with my findings on the impact of outdoor dining. The article shares a specific incident at a Brooklyn wine bar where an unusual smell was traced to something decaying beneath the outdoor dining structure, inaccessible without tearing up the entire parklet. This story highlights how outdoor dining setups, while beneficial for restaurants, inadvertently created new habitats for rats by providing shelter and easier access to food waste.\nI think we can all agree that during the peak of COVID-19 in 2020, rat populations initially declined due to the closure of restaurants, which limited food availability. Sontag’s article describes reports of starving rats resorting to cannibalism as food sources dwindled. However, the reopening of restaurants, particularly with outdoor dining spaces and street-side cooking, reversed this trend by creating an abundance of food once again. As a result, rats rapidly reappeared, with infestations increasing across neighborhoods.\nThis finding aligns with my analysis, which shows a notable correlation between rat activity and outdoor dining violations post-COVID. The lack of adequate waste management in outdoor setups further exacerbated the problem, leading to lawsuits demanding stricter sanitation measures and reconsideration of outdoor dining practices. The issue is not unique to NYC; cities like New Orleans, Chicago, and Los Angeles have reported unprecedented increases in rat sightings following the rise of outdoor dining. These observations emphasize the need for improved waste management strategies to address the unintended consequences of outdoor dining on urban rat infestations.\n\n\n\n\nPost-COVID: The rise/ existing in unauthorized outdoor dining, lack of proper waste management, street cooking, and similar activities have likely exacerbated rat infestations, emphasizing the importance of effective waste management.\nPreventative Measures: To mitigate rat infestations, stricter enforcement of sanitation protocols for outdoor seating areas is necessary, especially in periods of increased outdoor dining activity.\n\n\n\n\nWe can see a positive relationship between the increase in outdoor seating violations and rat infestation, particularly in 2024."
  },
  {
    "objectID": "individual_report.html#restaurants-a-vital-part-of-nyc-and-their-role-in-rat-infestation",
    "href": "individual_report.html#restaurants-a-vital-part-of-nyc-and-their-role-in-rat-infestation",
    "title": "Final Individual Report",
    "section": "",
    "text": "Restaurants are a key part of NYC’s culture and economy, providing jobs, tourism, and vibrant dining spaces. However, poor sanitation and the rise of outdoor dining have contributed to rat infestations by increasing food waste and trash.\nNow, we will analyze the correlation between restaurant density and rat population across NYC boroughs. Higher restaurant density, especially those with poor grades (B and C), may attract and sustain larger rat populations, highlighting the connection between restaurant presence and rat infestations in NYC.\n\n\n\nHigher restaurant density contributes to increased rat activity due to improper waste management, food availability, and urban environmental factors.\n\n\n\nshow the code\n# Step 1: Prepare ZIP Code Mapping -------------------------------------------\nzipcode_mapping &lt;- zipcode_mapping %&gt;%\n  mutate(ZIPCODE = str_trim(as.character(Zipcode)),\n         BOROUGH = str_trim(as.character(Borough)))\n\n# Step 2: Fill NA or Invalid BORO in Restaurant Data -------------------------\nrestaurant_filtered_zb &lt;- restaurant_filtered_data %&gt;%\n  mutate(ZIPCODE = str_trim(as.character(ZIPCODE)),  # Trim and convert ZIPCODE\n         BORO = ifelse(is.na(BORO) | BORO == \"0\", \n                       coalesce(zipcode_mapping$BOROUGH[match(ZIPCODE, zipcode_mapping$ZIPCODE)], BORO),\n                       BORO))\n\n# Step 3: Fill NA or Invalid BOROUGH in Rat Data -----------------------------\nrats_filtered_zb &lt;- rats_filtered_data %&gt;%\n  mutate(ZIP_CODE = str_trim(as.character(ZIP_CODE)),  # Trim and convert ZIP_CODE\n         BOROUGH = coalesce(zipcode_mapping$BOROUGH[match(ZIP_CODE, zipcode_mapping$ZIPCODE)], BOROUGH))\n\n\n# Step 2: Filter Rat Data for Rat Activity -----------------------------------\nrat_activity &lt;- rats_filtered_zb %&gt;%\n  filter(!RESULT %in% c(\"Passed\", \"Failed for Other R\")) %&gt;%\n  filter(!is.na(LATITUDE) & !is.na(LONGITUDE)) %&gt;%\n  group_by(BOROUGH) %&gt;%\n  summarise(Rat_Activity_Count = n())\n\n# Step 3: Aggregate Restaurant Data by Borough ------------------------------\nrestaurant_density &lt;- restaurant_filtered_zb %&gt;%\n  filter(!is.na(Latitude) & !is.na(Longitude)) %&gt;%\n  group_by(BORO) %&gt;%\n  summarise(Restaurant_Count = n())\n\n# Step 4: Merge Data ---------------------------------------------------------\ndensity_data &lt;- restaurant_density %&gt;%\n  mutate(BORO = str_to_lower(str_trim(BORO))) %&gt;%\n  inner_join(\n    rat_activity %&gt;%\n      mutate(BOROUGH = str_to_lower(str_trim(BOROUGH))),\n    by = c(\"BORO\" = \"BOROUGH\")\n  )\n\n# Step 5: Visualization ------------------------------------------------------\n\nggplot(density_data, aes(x = Restaurant_Count, y = Rat_Activity_Count, label = BORO)) +\n  geom_point(size = 4, color = \"blue\") +                               # Scatter points\n  geom_smooth(method = \"lm\", color = \"red\", se = TRUE) +               # Trendline with confidence interval\n  geom_text_repel(aes(label = paste0(BORO, \" (\", Restaurant_Count, \", \", Rat_Activity_Count, \")\")),\n                  size = 4, color = \"black\", box.padding = 0.5) +      # Add BORO and coordinates\n  scale_y_continuous(labels = comma) +                                 # Format y-axis as whole numbers\n  scale_x_continuous(labels = comma) +                                 # Format x-axis as whole numbers\n  labs(title = \"Density of Restaurants vs Rat Activity\",\n       subtitle = \"Analyzing Relationship Between Restaurants and Rat Infestation Rates\",\n       x = \"Number of Restaurants (Density)\",\n       y = \"Number of Rat Activity Inspections\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\nPositive Correlation:\n\nThe graph shows a slight positive correlation between the number of restaurants (restaurant density) and the number of rat activity inspections.\nBoroughs with higher restaurant density, such as Manhattan and Brooklyn, also exhibit higher rat activity inspections.\n\nManhattan and Brooklyn:\n\nThese boroughs have the highest restaurant densities (e.g., Manhattan: ~94,661 restaurants) and significant rat activity counts (e.g., 136,963 inspections).\nThis suggests that areas with concentrated restaurant activity may experience increased rat infestations due to factors such as waste generation.\n\nLow-Density Areas:\n\nStaten Island has the lowest restaurant density (~9,218 restaurants) and rat activity inspections (~2,049). This aligns with the general trend that lower restaurant density areas tend to have lower rat activity.\n\nOutliers:\n\nThe Bronx appears to have a higher number of rat activity inspections relative to its restaurant density (~23,274 restaurants, ~96,498 inspections). This could indicate other contributing factors, such as waste management issues or urban infrastructure challenges.\n\n\n\n\n\n\nTargeted Waste Management Policies: Boroughs with higher restaurant density, like Manhattan and Brooklyn, require stricter waste management practices to mitigate rat infestations.\nFurther Investigation: The Bronx’s higher rat activity relative to restaurant density warrants further analysis into non-restaurant-related factors contributing to infestations."
  },
  {
    "objectID": "individual_report.html#limitations-of-our-assumptions",
    "href": "individual_report.html#limitations-of-our-assumptions",
    "title": "Final Individual Report",
    "section": "",
    "text": "Data Quality: Our analysis relies on inspection data, which may not capture all instances of rat activity or sanitation violations. Underreporting or delayed reporting could affect the results.\nSpatial Accuracy: We assume a 100-meter radius for rat sightings around outdoor dining violations, which may not accurately reflect rats’ mobility or the true impact area.\nCausality vs. Correlation: While we found correlations between restaurant density, sanitation, and rat activity, this does not prove direct causality. Other\nunderlying factors might contribute to the observed patterns.\nCOVID-19 Impact: The unique circumstances of the COVID-19 pandemic, such as temporary outdoor dining policies and changes in waste management services, could distort long-term trends."
  },
  {
    "objectID": "ndividual_report.html",
    "href": "ndividual_report.html",
    "title": "Final Individual Report",
    "section": "",
    "text": "New York City restaurant’s persistent struggle with rat infestations has raised concerns about various contributing factors, particularly the role of restaurants. By their nature, restaurants generate significant food waste, and when sanitation practices are inadequate, they create ideal conditions for rats to thrive. This research examines the correlation between restaurant sanitation grades (B and C) and rat activity, as well as the influence of restaurant density on reported rat sightings across neighborhoods.\nThe study also explores the impact of outdoor dining, which expanded significantly during the COVID-19 pandemic. While outdoor dining supported businesses, it may have inadvertently contributed to rat infestations by increasing food access and improperly managed waste. By analyzing trends in restaurant grades, density, and rat activity over time, we aim to determine whether outdoor dining has exacerbated the rat problem in certain areas.\nThrough this analysis, we seek to identify patterns and relationships that highlight how restaurant practices contribute to urban rat populations. These insights are critical for developing targeted interventions to mitigate rat infestations and improve public health across NYC neighborhoods.\n\n\n\n\nshow the code\nlibrary(tidyverse)\nlibrary(sf)\nlibrary(leaflet)\nlibrary(lubridate)\nlibrary(janitor)\nlibrary(geosphere)\nlibrary(httr)\nlibrary(jsonlite)\nlibrary(readr)\nlibrary(data.table)\nlibrary(stringr)\nlibrary(scales)\nlibrary(gridExtra)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(geosphere)\nlibrary(lubridate)\nlibrary(tidyr)\nlibrary(ggrepel) \nlibrary(knitr)\n\n\n\n\n\n\n\nshow the code\n# Get the current working directory\ncurrent_path &lt;- getwd()\n\n# Define the 'data' directory path\ndata_directory &lt;- file.path(current_path, \"Rat_Data\")\n\n# Check if the directory exists, and create it if it doesn't\nif (!dir.exists(data_directory)) {\n  success &lt;- dir.create(data_directory, recursive = TRUE)\n  if (success) {\n    message(\"Directory 'Data' created successfully at: \", data_directory)\n  } else {\n    stop(\"Failed to create directory 'Data'. Check permissions or file system.\")\n  }\n} else {\n  message(\"Directory 'Data' already exists at: \", data_directory)\n}\n\n\nData Sources and Rationale \nWe are automating data analysis using two publicly available data sets from NYC Open Data:\n\nDOHMH New York City Restaurant Inspection Results\nRats\n\nWe chose these data sets because they contain detailed information about rat infestations in New York City, collected by the NYC Department of Health and Mental Hygiene (DOHMH), Division of Environmental Health Pest Control. By leveraging this data, we aim to analyze the prevalence and distribution of rat activity across various NYC neighborhoods.\nMethodology\nWe focus on inspection data from 2019, extracting relevant columns and combining the two data sets using zip codes as the common key for integration. The combined data is then cleaned and pre-processed to align with the requirements of our analysis.\nData Limitations\nInspection Bias: The data set does not indicate the absence of rats in areas that were not inspected. This can create an illusion of lower rat activity in neighborhoods with fewer inspections. Similarly, areas with higher rates of active rat signs may reflect more frequent inspections rather than a genuinely higher rat population.\nMissing Data: A significant number of empty rows exist within the datasets, which necessitates careful and thorough cleaning to ensure the accuracy and reliability of our analysis. By addressing these limitations and ensuring a robust data-cleaning process, we aim to produce meaningful insights into rat infestation patterns and their correlations with restaurant inspection data.\n\n\nshow the code\n# Increase timeout limit to 300 seconds\noptions(timeout = 300)\n\n\n# Define output filenames\nrats_file &lt;- file.path(data_directory, \"Rats_Inspection_Full.csv\")\nrestaurant_file &lt;- file.path(data_directory, \"Restaurant_Inspection_Full.csv\")\n\n# rats_file &lt;- \"Rats_Inspection_Full.csv\"\n# restaurant_file &lt;- \"Restaurant_Inspection_Full.csv\"\n\n# Load and filter the Rats data starting from 2019\nrats_data &lt;- read_csv(rats_file,show_col_types=FALSE)\nrats_filtered_data &lt;- rats_data %&gt;%\n  filter(as.Date(`INSPECTION_DATE`, format = \"%m/%d/%Y\") &gt;= as.Date(\"2019-01-01\"))\n\n\nrats_filtered_file_path &lt;- file.path(data_directory, \"Rats_Inspection_2019_onwards.csv\")\nwrite.csv(rats_filtered_data, rats_filtered_file_path, row.names=FALSE)\n#message(\"Filtered Rats data saved to 'Rats_Inspection_2019_onwards.csv'\")\n\n\n# Data 2\n# Load and filter the Restaurant Inspection data starting from 2019\nrestaurant_file &lt;- file.path(data_directory, \"Restaurant_Inspection_Full.csv\")\nrestaurant_data &lt;- read_csv(restaurant_file,show_col_types=FALSE)\nrestaurant_filtered_data &lt;- restaurant_data %&gt;%\n  filter(as.Date(`INSPECTION DATE`, format = \"%m/%d/%Y\") &gt;= as.Date(\"2019-01-01\"))\n\nrestaurant_filtered_file_path &lt;- file.path(data_directory, \"Rats_Inspection_2019_onwards.csv\")\nwrite.csv(restaurant_filtered_data, restaurant_filtered_file_path, row.names=FALSE)\n#message(\"Filtered Restaurant Inspection data saved to 'Restaurant_Inspection_2019_onwards.csv'\")\n\n\nzipcode_mapping &lt;- read_csv(\"Rat_data/zipcode_borough.csv\", show_col_types=FALSE)  # Mapping of ZIP codes to Boroughs\n# \nkable(head( rats_filtered_data,5))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nINSPECTION_TYPE\nJOB_TICKET_OR_WORK_ORDER_ID\nJOB_ID\nJOB_PROGRESS\nBBL\nBORO_CODE\nBLOCK\nLOT\nHOUSE_NUMBER\nSTREET_NAME\nZIP_CODE\nX_COORD\nY_COORD\nLATITUDE\nLONGITUDE\nBOROUGH\nINSPECTION_DATE\nRESULT\nAPPROVED_DATE\nLOCATION\nCOMMUNITY BOARD\nCOUNCIL DISTRICT\nCENSUS TRACT\nBIN\nNTA\n\n\n\n\nInitial\n13661515\nPC8122655\n1\nNA\n1\n00529\n0009\nNA\nNA\n0\nNA\nNA\nNA\nNA\nManhattan\n06/07/2023 04:36:13 PM\nPassed\n06/08/2023 10:38:30 AM\nNA\nNA\nNA\nNA\nNA\nNA\n\n\nInitial\n13264492\nPC7744572\n1\nNA\n2\n02857\n0095\n0000\nJEROME AVENUE\nNA\nNA\nNA\n0\n0\nBronx\n07/28/2021 12:48:53 PM\nPassed\n07/29/2021 01:19:32 PM\n(0.0, 0.0)\nNA\nNA\nNA\nNA\nNA\n\n\nInitial\n13252138\nPC7732344\n1\nNA\n2\n02409\n0059\nNA\nNA\n10451\nNA\nNA\nNA\nNA\nBronx\n07/07/2021 08:49:45 AM\nPassed\n07/08/2021 10:18:56 AM\nNA\nNA\nNA\nNA\nNA\nNA\n\n\nInitial\n13432908\nPC7906420\n1\nNA\n2\n02420\n0078\n0000\nEAST 161 STREET\nNA\nNA\nNA\n0\n0\nBronx\n07/19/2022 01:50:56 PM\nPassed\n07/20/2022 11:03:35 AM\n(0.0, 0.0)\nNA\nNA\nNA\nNA\nNA\n\n\nInitial\n13392717\nPC7869938\n1\nNA\n2\n02509\n0044\n0000\nWOODYCREST AVENUE\nNA\nNA\nNA\n0\n0\nBronx\n05/20/2022 01:08:51 PM\nPassed\n05/23/2022 10:36:46 AM\n(0.0, 0.0)\nNA\nNA\nNA\nNA\nNA\n\n\n\n\n\nshow the code\nkable(head( restaurant_filtered_data,5))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCAMIS\nDBA\nBORO\nBUILDING\nSTREET\nZIPCODE\nPHONE\nCUISINE DESCRIPTION\nINSPECTION DATE\nACTION\nVIOLATION CODE\nVIOLATION DESCRIPTION\nCRITICAL FLAG\nSCORE\nGRADE\nGRADE DATE\nRECORD DATE\nINSPECTION TYPE\nLatitude\nLongitude\nCommunity Board\nCouncil District\nCensus Tract\nBIN\nBBL\nNTA\nLocation Point1\n\n\n\n\n50105051\nThe Legend Lounge\nManhattan\n2509\nADAM CLAYTON POWELL JR BOULEVARD\nNA\n7186712232\nOther\n12/17/2021\nViolations were cited in the following area(s).\n15E2\nFlavored tobacco products sold or offered for sale\nNot Applicable\nNA\nNA\nNA\n12/07/2024\nSmoke-Free Air Act / Initial Inspection\n0.00000\n0.00000\nNA\nNA\nNA\nNA\n1\nNA\nNA\n\n\n40376515\nAMERICAN MUSEUM OF NATURAL HISTORY FOOD COURT\nManhattan\nNA\nW 79 STREET\n10024\n2127695370\nAmerican\n06/21/2023\nNo violations were recorded at the time of this inspection.\nNA\nNA\nNot Applicable\n0\nA\n06/21/2023\n12/07/2024\nCycle Inspection / Initial Inspection\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\n\n\n41574266\nMOMOFUKU MILK BAR\nManhattan\n251\nEAST 13 STREET\n10003\n3475779504\nCoffee/Tea\n10/12/2024\nNo violations were recorded at the time of this inspection.\nNA\nNA\nNot Applicable\n0\nNA\nNA\n12/07/2024\nInter-Agency Task Force / Initial Inspection\n40.73212\n-73.98654\n103\n02\n004000\n1006911\n1004690037\nMN22\nNA\n\n\n50133642\nMATCHA Cafe MAIKO\nQueens\n13333\n39TH AVE\n11354\n3473998961\nCoffee/Tea\n10/05/2024\nNo violations were recorded at the time of this inspection.\nNA\nNA\nNot Applicable\n0\nNA\nNA\n12/07/2024\nInter-Agency Task Force / Initial Inspection\n40.75911\n-73.83416\n407\n20\n087100\n4000000\n4049727504\nQN22\nNA\n\n\n41081510\nCHOP’T\nManhattan\n60\nEAST 56 STREET\n10022\n2127502467\nSalads\n03/03/2022\nViolations were cited in the following area(s).\n02B\nHot food item not held at or above 140º F.\nCritical\n10\nA\n03/03/2022\n12/07/2024\nCycle Inspection / Re-inspection\n40.76135\n-73.97226\n105\n04\n010200\n1035773\n1012910045\nMN17\nNA\n\n\n\n\n\n\n\n\n\n\n\nBoroughs with a higher number of Grade B and C restaurants are more likely to experience elevated rat sighting, particularly in localized ZIP codes. Poor sanitation practices associated with lower restaurant grades likely contribute to rat infestations.\n\nTo address the limitations of missing data and analyze the relationship between poor restaurant sanitation and rat activity, we focused on restaurants with Grades B and C and rat density across ZIP Codes in the five boroughs of New York City: Bronx, Brooklyn, Manhattan, Queens, and Staten Island.\nData Cleaning and Standardization\n\nZIP Code Validation: The data was cleaned and standardized to ensure all ZIP Codes were valid and accurately mapped to their respective boroughs using a ZIP\nCode-to-borough mapping file.\nRestaurant Sanitation Data:\nRestaurants receiving sanitation Grades B and C, which indicate lower sanitation standards, were filtered and counted for each ZIP Code.\nRat Density Data: Rat activity data was filtered to exclude inspections resulting in “Passed” or “Failed for Other R” outcomes. This provided a more\nreliable measure of rat activity by focusing on confirmed rodent sightings or infestations.\n\nMerging and Analysis\nThe cleaned restaurant sanitation data and rat density data were merged using ZIP Codes as the key. This integration allowed us to directly compare the number of restaurants with lower sanitation grades to rat activity within each ZIP Code.\nThis process ensured a comprehensive analysis of how poor sanitation practices in restaurants might correlate with increased rat infestations across New York City neighborhoods.\n\n\nshow the code\n# Step 1: Clean ZIP Codes and Map Boroughs -----------------------------------\nzipcode_mapping &lt;- zipcode_mapping %&gt;%\n  mutate(ZIPCODE = str_trim(as.character(Zipcode)),\n         BOROUGH = str_trim(as.character(Borough)))\n\n# Clean and map restaurant data\nrestaurants_clean &lt;- restaurant_filtered_data %&gt;%\n  mutate(ZIPCODE = str_trim(as.character(ZIPCODE)),\n         ZIPCODE = ifelse(str_length(ZIPCODE) == 5, ZIPCODE, NA)) %&gt;%  # Ensure valid 5-digit ZIP codes\n  filter(!is.na(ZIPCODE)) %&gt;%\n  mutate(BORO = ifelse(is.na(BORO), \n                       zipcode_mapping$BOROUGH[match(ZIPCODE, zipcode_mapping$ZIPCODE)], \n                       BORO))\n\n# Filter for restaurants with Grades B and C\nrestaurants_bc &lt;- restaurants_clean %&gt;%\n  filter(GRADE %in% c(\"B\", \"C\")) %&gt;%\n  group_by(BORO, ZIPCODE) %&gt;%\n  summarise(Restaurants_Grade_BC = n(), .groups = \"drop\")\n\n# Clean and map rat data\nrats_clean &lt;- rats_filtered_data %&gt;%\n  mutate(ZIP_CODE = str_trim(as.character(ZIP_CODE)),\n         ZIP_CODE = ifelse(str_length(ZIP_CODE) == 5, ZIP_CODE, NA)) %&gt;%\n  filter(!is.na(ZIP_CODE), !RESULT %in% c(\"Passed\", \"Failed for Other R\")) %&gt;%\n  mutate(BOROUGH = ifelse(is.na(BOROUGH), \n                          zipcode_mapping$BOROUGH[match(ZIP_CODE, zipcode_mapping$ZIPCODE)], \n                          BOROUGH)) %&gt;%\n  group_by(BOROUGH, ZIP_CODE) %&gt;%\n  summarise(Rat_Density = n(), .groups = \"drop\")\n\n# Step 2: Combine Data -------------------------------------------------------\ncombined_data &lt;- full_join(restaurants_bc, rats_clean, \n                           by = c(\"ZIPCODE\" = \"ZIP_CODE\", \"BORO\" = \"BOROUGH\")) %&gt;%\n  replace_na(list(Restaurants_Grade_BC = 0, Rat_Density = 0))\n\nkable(head(combined_data, 5))\n\n\n\n\n\nBORO\nZIPCODE\nRestaurants_Grade_BC\nRat_Density\n\n\n\n\nBronx\n10451\n103\n4515\n\n\nBronx\n10452\n105\n9205\n\n\nBronx\n10453\n93\n7843\n\n\nBronx\n10454\n91\n1907\n\n\nBronx\n10455\n132\n3159\n\n\n\n\n\nshow the code\n# Step 3: Generate Plots for Each Borough ------------------------------------\nplot_list &lt;- list()\n\nboroughs &lt;- unique(combined_data$BORO)\n\n# Loop through each borough and create plots\nfor (b in boroughs) {\n  data_borough &lt;- combined_data %&gt;% filter(BORO == b)\n  \n  # Plot 1: Number of Restaurants (Grade B and C) by ZIP Code\n  plot_bc &lt;- ggplot(data_borough, aes(x = ZIPCODE, y = Restaurants_Grade_BC, group = 1)) +\n    geom_line(color = \"blue\", size = 1) +\n    geom_point(color = \"blue\", size = 2) +\n    labs(title = paste(\"Number of Restaurants with Grade B and C -\", b),\n         x = \"ZIP Code\", y = \"Number of Restaurants\") +\n    theme_minimal() +\n    theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 10),\n          plot.title = element_text(size = 12, face = \"bold\")) +\n    scale_y_continuous(labels = comma)\n  \n  # Plot 2: Rat Density by ZIP Code\n  plot_rats &lt;- ggplot(data_borough, aes(x = ZIPCODE, y = Rat_Density, group = 1)) +\n    geom_line(color = \"red\", size = 1) +\n    geom_point(color = \"red\", size = 2) +\n    labs(title = paste(\"Rat Sighting per ZIP Code -\", b),\n         x = \"ZIP Code\", y = \"Rat Sighting\") +\n    theme_minimal() +\n    theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 10),\n          plot.title = element_text(size = 12, face = \"bold\")) +\n    scale_y_continuous(labels = comma)\n  \n  # Arrange the two plots vertically (one on top of the other)\n  combined_plot &lt;- grid.arrange(plot_bc, plot_rats, ncol = 1)  # Use ncol = 1 for vertical layout\n  plot_list[[b]] &lt;- combined_plot\n  \n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nBronx:\n\nThe ZIP codes 10457 and 10458 show higher rat density (above 12,000) while also exhibiting a significant number of restaurants with Grade B and C.\nThere seems to be a noticeable link between the increase in rat activity and areas with more restaurants receiving lower grades.\n\nBrooklyn:\n\nZIP codes 11215 and 11222 show the highest rat densities (over 20,000), corresponding to relatively high numbers of restaurants with Grade B and C.\nRat infestations in Brooklyn appear to cluster in specific ZIP codes, suggesting that localized waste management issues may be contributing to the problem.\n\nManhattan:\n\nZIP codes 10013 and 10036 have both the highest number of restaurants with Grade B and C (over 600) and noticeable rat activity.\nDespite a significant concentration of lower-graded restaurants, rat densities remain moderate compared to other boroughs, suggesting more effective urban management in some areas.\n\nQueens:\n\nZIP codes 11385 and 11373 show the highest rat densities and a considerable number of restaurants with Grade B and C.\nRat density appears to peak sharply in specific ZIP codes, correlating with localized concentrations of lower-graded restaurants.\n\nStaten Island:\n\nStaten Island has the lowest rat  across all ZIP codes, with a small number of lower-graded restaurants.\nZIP code 10301 has the highest rat density (600) but relatively fewer restaurants compared to other boroughs.\n\n\n\n\nshow the code\noptions(tigris_progress = FALSE)\n\n\nlibrary(tigris)     # Fetch borough boundaries\nlibrary(sf)         # Spatial data\nlibrary(dplyr)      # Data manipulation\nlibrary(ggplot2)    # Visualization\nlibrary(ggrepel)    # Improved text labels\nlibrary(zipcodeR)   # st want to Fetch latitude/longitude for ZIP codes\nlibrary(gganimate)  # Animation\n#options(gganimate.dev = gifski_renderer())\nlibrary(transformr) # Smooth animations\nlibrary(gifski)\nlibrary(av)\n\n\n# Step 1: Fetch NYC Borough Boundaries -----------------------------------------\nnyc_boroughs &lt;- counties(state = \"NY\", cb = TRUE, resolution = \"5m\", year = 2022) %&gt;%\n  filter(NAME %in% c(\"Bronx\", \"Kings\", \"New York\", \"Queens\", \"Richmond\")) # NYC counties\n\n# Calculate centroid of each borough for annotation\nborough_centroids &lt;- nyc_boroughs %&gt;%\n  st_centroid() %&gt;%\n  st_coordinates() %&gt;%\n  as.data.frame() %&gt;%\n  bind_cols(Borough = nyc_boroughs$NAME)\n\n# Step 2: Filter High-Density Data ---------------------------------------------\n# Filter for areas with high restaurant density and rat population\nhigh_density_data &lt;- combined_data %&gt;%\n  filter(Restaurants_Grade_BC &gt; 100 & Rat_Density &gt; 500)\n\n# Step 3: Add Coordinates to ZIP Codes -----------------------------------------\n# Fetch latitude and longitude for ZIP codes using zipcodeR\nhigh_density_data &lt;- high_density_data %&gt;%\n  mutate(coords = purrr::map(ZIPCODE, reverse_zipcode)) %&gt;%\n  tidyr::unnest_wider(coords) %&gt;% \n  filter(!is.na(lat) & !is.na(lng)) %&gt;% # Ensure valid coordinates\n  rename(Longitude = lng, Latitude = lat) %&gt;%\n  arrange(BORO, ZIPCODE) %&gt;%  # Arrange for animation\n  mutate(step = row_number()) # Add animation sequence\n\n# Update borough names\nborough_centroids &lt;- borough_centroids %&gt;%\n  mutate(Borough = case_when(\n    Borough == \"New York\" ~ \"Manhattan\",\n    Borough == \"Kings\" ~ \"Brooklyn\",\n    Borough == \"Richmond\" ~ \"Staten Island\",\n    TRUE ~ Borough\n  ))\n\n# Step 4: Create the Animated Map with Borough Annotations ---------------------\nanimated_map &lt;- ggplot() +\n  # Plot borough boundaries\n  geom_sf(data = nyc_boroughs, fill = \"lightgray\", color = \"white\") +\n  \n  # Add borough names at centroid positions\n  geom_text(data = borough_centroids, \n            aes(x = X, y = Y, label = Borough), \n            color = \"black\", size = 5, fontface = \"bold\") +\n\n  # Add animated pins for high-density areas\n  geom_point(data = high_density_data, \n             aes(x = Longitude, y = Latitude, group = step), \n             color = \"red\", size = 3) +\n  \n  # Add ZIP Code labels\n  geom_text_repel(data = high_density_data, \n                  aes(x = Longitude, y = Latitude, label = ZIPCODE), \n                  size = 3) +\n  \n  # Titles and captions\n  labs(title = \"High-Density Restaurant and Rat Population Areas in NYC\",\n       subtitle = \"Sequential display of ZIP Codes with high density\",\n       caption = \"Data Source: NYC Open Data & tigris\") +\n  \n  # Animation\n  transition_reveal(along = step) +  # Sequential animation\n  enter_grow() +                     # Pins grow as they appear\n  exit_fade() +                      # Optional: Pins fade out\n  theme_minimal()\n\n# Step 5: Render and Save the Animation ----------------------------------------\n# animate(animated_map, nframes = 50, fps = 2, width = 600, height = 400, renderer = gifski_renderer())\n\n# anim_save(\"nyc_high_density_animation.gif\")\n# \n# knitr::include_graphics(\"nyc_high_density_animation.gif\")\n\n\n\n\n\n\n\nLocalized Rat Clusters:\n\nRat density is not uniformly distributed; specific ZIP codes within boroughs, such as 10457 (Bronx) and 11215 (Brooklyn), experience disproportionately high rat activity.\n\nBorough-Specific Trends:\n\nManhattan: Despite high restaurant density, rat activity remains moderate.\nBrooklyn and Bronx: Exhibit stronger correlations between rat density and restaurants with lower grades.\nStaten Island: Shows consistently lower rat activity, indicating better overall sanitation.\n\nTargeted Interventions:\n\nZIP codes with high numbers of Grade B and C restaurants should be prioritized for sanitation inspections and waste management improvements to reduce rat activity.\n\n\n\n\n\nThe analysis highlights a positive relationship between the number of restaurants with lower grades (B and C) and rat activity density, especially in high-density boroughs like the Bronx, Brooklyn, and Queens. Effective sanitation practices and targeted interventions in identified ZIP codes are critical to addressing this issue.\n\n\n\n\n\nOutdoor dining in New York City became a significant part of the restaurant scene, particularly during the COVID-19 pandemic, when it was rapidly expanded to allow restaurants to operate on sidewalks, streets, and other open spaces. While this initiative provided safer dining options and supported businesses, it also brought challenges related to sanitation and waste management. Food scraps, improperly stored trash, and debris from outdoor setups created an environment that attracted pests, particularly rats, leading to increased health code violations and rat sightings.\nTo analyze if outdoor dining has caused an increase in rat infestations, we will compare rat sightings near outdoor dining violations over time. By identifying outdoor seating violations and checking for rat inspections within a 100-meter radius, we can observe patterns and trends. Specifically, we will focus on the pandemic years (2020-2022) when outdoor dining expanded significantly, to determine if rat infestation rates increased in these areas compared to previous years.\n\n\n\nThe increase in outdoor seating violations after COVID (2020-2022) may have contributed to higher rat infestation rates. This could be due to improper waste management and sanitation practices around outdoor dining areas.\n\n\n\nshow the code\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(geosphere)\nlibrary(lubridate)\n\n\n# Filter rat inspections with valid lat/lon and failed results\nrats_filtered_loc &lt;- rats_filtered_data %&gt;%\n  filter(!is.na(LATITUDE) & !is.na(LONGITUDE) & RESULT != \"Passed\") %&gt;%\n  mutate(YEAR = year(mdy_hms(INSPECTION_DATE)))\n\n# Extract outdoor seating violations from restaurants\noutdoor_seating &lt;- restaurant_filtered_data %&gt;%\n  filter(grepl(\"outdoor|seating|sidewalk\", `VIOLATION DESCRIPTION`, ignore.case = TRUE)) %&gt;%\n  filter(!is.na(Latitude) & !is.na(Longitude)) %&gt;%\n  mutate(YEAR = year(mdy(`INSPECTION DATE`)))\n\n# Select coordinates for rats and outdoor seating\noutdoor_coords &lt;- outdoor_seating %&gt;% \n  select(Latitude, Longitude) %&gt;% \n  filter(!is.na(Latitude) & !is.na(Longitude)) %&gt;%\n  na.omit()\n\nrat_coords &lt;- rats_filtered_loc %&gt;% \n  select(LATITUDE, LONGITUDE) %&gt;%\n  filter(!is.na(LATITUDE) & !is.na(LONGITUDE)) %&gt;%\n  na.omit()\n\n# Function to check for nearby rats (100 meters)\nfind_rats_nearby &lt;- function(outdoor_coords, rat_coords, distance_threshold = 100) {\n  # Ensure both inputs are matrices with exactly two columns\n  rat_coords &lt;- as.matrix(rat_coords[, c(1, 2)])\n  outdoor_coords &lt;- as.matrix(outdoor_coords[, c(1, 2)])\n  \n  # Validate column names and types\n  if (ncol(rat_coords) != 2 | ncol(outdoor_coords) != 2) {\n    stop(\"Error: Inputs must have exactly two columns (latitude, longitude).\")\n  }\n  \n  result &lt;- sapply(1:nrow(outdoor_coords), function(i) {\n    point &lt;- outdoor_coords[i, ]  # Current restaurant coordinates\n    distances &lt;- distHaversine(matrix(point, nrow = 1), rat_coords)  # Distance to all rat points\n    any(distances &lt;= distance_threshold)  # TRUE if within threshold\n  })\n  return(result)\n}\n\n# Apply the corrected function\noutdoor_seating$RAT_INFESTATION_NEARBY &lt;- find_rats_nearby(outdoor_coords, rat_coords)\n\n\n# Select specific columns\nselected_columns &lt;- outdoor_seating %&gt;%\n  select(\"DBA\",\"BORO\",\"ZIPCODE\", \"YEAR\",`VIOLATION CODE`, 'RAT_INFESTATION_NEARBY')\n\n# Print the selected columns\nkable(head(selected_columns, 6))\n\n\n\n\n\n\n\n\n\n\n\n\n\nDBA\nBORO\nZIPCODE\nYEAR\nVIOLATION CODE\nRAT_INFESTATION_NEARBY\n\n\n\n\nBLUESTONE LANE\nManhattan\n10128\n2024\n28-07\nTRUE\n\n\nSTEVE’S ORIGINAL JERK CHICKEN\nBrooklyn\n11203\n2022\n28-07\nTRUE\n\n\nG & S RESTAURANT\nBronx\n10466\n2024\n28-07\nTRUE\n\n\nTWO BROTHERS FISH & CHIPS\nBrooklyn\n11206\n2023\n28-07\nTRUE\n\n\nZOUJI BBQ\nQueens\n11355\n2024\n28-07\nTRUE\n\n\nNIEVES TIA MIMI ICES\nBrooklyn\n11220\n2024\n28-07\nTRUE\n\n\n\n\n\nshow the code\n# Group by year and count rat infestations near outdoor seating violations\nrat_summary &lt;- outdoor_seating %&gt;%\n  filter(RAT_INFESTATION_NEARBY == TRUE) %&gt;%\n  group_by(YEAR) %&gt;%\n  summarise(Rat_Infestations = n())\n\n# Summarize total outdoor seating violations by year\noutdoor_summary &lt;- outdoor_seating %&gt;%\n  group_by(YEAR) %&gt;%\n  summarise(Outdoor_Violations = n())\n\n# Combine the two summaries\ncombined_summary &lt;- full_join(outdoor_summary, rat_summary, by = \"YEAR\") %&gt;%\n  replace_na(list(Outdoor_Violations = 0, Rat_Infestations = 0))\n\n# Visualization --------------------------------------------------------------\nggplot(combined_summary, aes(x = YEAR)) +\n  geom_bar(aes(y = Outdoor_Violations, fill = \"Outdoor Violations\"), \n           stat = \"identity\", position = \"dodge\") +\n  geom_line(aes(y = Rat_Infestations, color = \"Rat Infestations\"), size = 1) +\n  scale_fill_manual(values = c(\"Outdoor Violations\" = \"steelblue\")) +\n  scale_color_manual(values = c(\"Rat Infestations\" = \"red\")) +\n  geom_rect(aes(xmin = 2020, xmax = 2022, ymin = 0, ymax = Inf), \n            fill = \"gray\", alpha = 0.2) +\n  labs(title = \"Impact of Outdoor Seating on Rat Infestation Rates\",\n       subtitle = \"Highlighted COVID Period (2020-2022)\",\n       x = \"Year\", y = \"Count\",\n       fill = \"Legend\", color = \"Legend\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\nOutdoor Violations:\n\nThere was a clear increase in outdoor seating violations after 2022.\nThe violations appear to be highest in 2024, following a gradual rise from 2022 to 2024.\n\nRat Infestation Rates:\n\nRat infestations near outdoor seating violations also showed a consistent upward trend, increasing sharply in 2023 and 2024.\nThe correlation suggests that as outdoor seating violations increase, rat infestations also rise.\n\nCOVID Period (2020-2022):\n\nThe shaded gray area highlights the COVID period (2020-2022), where the counts of outdoor seating violations and rat infestations were relatively lower compared to post-COVID years.\nPost-2022, there is a notable rise in both outdoor violations and rat infestations.\n\n\n\n\n\n\nPost-COVID: The rise/ existing in unauthorized outdoor dining, lack of proper waste management, street cooking, and similar\nactivities have likely exacerbated rat infestations, emphasizing the importance of effective waste management.\nPreventative Measures: To mitigate rat infestations, stricter enforcement of sanitation protocols for outdoor seating areas is necessary, especially in periods of increased outdoor dining activity.\n\n\n\n\nWe can see a positive relationship between the increase in outdoor seating violations and rat infestation, particularly in 2024.\n\n\n\n\n(Relevant article)\nA report by Elazar Sontag in Eater (December 14, 2021) provides critical insights into the rise of rat infestations in New York City post-COVID-19, aligning with my findings on the impact of outdoor dining. The article shares a specific incident at a Brooklyn wine bar where an unusual smell was traced to something decaying beneath the outdoor dining structure, inaccessible without tearing up the entire parklet. This story highlights how outdoor dining setups, while beneficial for restaurants, inadvertently created new habitats for rats by providing shelter and easier access to food waste.\nI think we can all agree that during the peak of COVID-19 in 2020, rat populations initially declined due to the closure of restaurants, which limited food availability. Sontag’s article describes reports of starving rats resorting to cannibalism as food sources dwindled. However, the reopening of restaurants, particularly with outdoor dining spaces and street-side cooking, reversed this trend by creating an abundance of food once again. As a result, rats rapidly reappeared, with infestations increasing across neighborhoods.\nThis finding aligns with my analysis, which shows a notable correlation between rat activity and outdoor dining violations post-COVID. The lack of adequate waste management in outdoor setups further exacerbated the problem, leading to lawsuits demanding stricter sanitation measures and reconsideration of outdoor dining practices. The issue is not unique to NYC; cities like New Orleans, Chicago, and Los Angeles have reported unprecedented increases in rat sightings following the rise of outdoor dining. These observations emphasize the need for improved waste management strategies to address the unintended consequences of outdoor dining on urban rat infestations.\n\n\n\n\nRestaurants are a key part of NYC’s culture and economy, providing jobs, tourism, and vibrant dining spaces. However, poor sanitation and the rise of outdoor dining have contributed to rat infestations by increasing food waste and trash.\nNow, we will analyze the correlation between restaurant density and rat population across NYC boroughs. Higher restaurant density, especially those with poor grades (B and C), may attract and sustain larger rat populations, highlighting the connection between restaurant presence and rat infestations in NYC.\n\n\n\nHigher restaurant density contributes to increased rat activity due to improper waste management, food availability, and urban environmental factors.\n\n\n\nshow the code\n# Step 1: Prepare ZIP Code Mapping -------------------------------------------\nzipcode_mapping &lt;- zipcode_mapping %&gt;%\n  mutate(ZIPCODE = str_trim(as.character(Zipcode)),\n         BOROUGH = str_trim(as.character(Borough)))\n\n# Step 2: Fill NA or Invalid BORO in Restaurant Data -------------------------\nrestaurant_filtered_zb &lt;- restaurant_filtered_data %&gt;%\n  mutate(ZIPCODE = str_trim(as.character(ZIPCODE)),  # Trim and convert ZIPCODE\n         BORO = ifelse(is.na(BORO) | BORO == \"0\", \n                       coalesce(zipcode_mapping$BOROUGH[match(ZIPCODE, zipcode_mapping$ZIPCODE)], BORO),\n                       BORO))\n\n# Step 3: Fill NA or Invalid BOROUGH in Rat Data -----------------------------\nrats_filtered_zb &lt;- rats_filtered_data %&gt;%\n  mutate(ZIP_CODE = str_trim(as.character(ZIP_CODE)),  # Trim and convert ZIP_CODE\n         BOROUGH = coalesce(zipcode_mapping$BOROUGH[match(ZIP_CODE, zipcode_mapping$ZIPCODE)], BOROUGH))\n\n\n# Step 2: Filter Rat Data for Rat Activity -----------------------------------\nrat_activity &lt;- rats_filtered_zb %&gt;%\n  filter(!RESULT %in% c(\"Passed\", \"Failed for Other R\")) %&gt;%\n  filter(!is.na(LATITUDE) & !is.na(LONGITUDE)) %&gt;%\n  group_by(BOROUGH) %&gt;%\n  summarise(Rat_Activity_Count = n())\n\n# Step 3: Aggregate Restaurant Data by Borough ------------------------------\nrestaurant_density &lt;- restaurant_filtered_zb %&gt;%\n  filter(!is.na(Latitude) & !is.na(Longitude)) %&gt;%\n  group_by(BORO) %&gt;%\n  summarise(Restaurant_Count = n())\n\n# Step 4: Merge Data ---------------------------------------------------------\ndensity_data &lt;- restaurant_density %&gt;%\n  mutate(BORO = str_to_lower(str_trim(BORO))) %&gt;%\n  inner_join(\n    rat_activity %&gt;%\n      mutate(BOROUGH = str_to_lower(str_trim(BOROUGH))),\n    by = c(\"BORO\" = \"BOROUGH\")\n  )\n\n# Step 5: Visualization ------------------------------------------------------\n\nggplot(density_data, aes(x = Restaurant_Count, y = Rat_Activity_Count, label = BORO)) +\n  geom_point(size = 4, color = \"blue\") +                               # Scatter points\n  geom_smooth(method = \"lm\", color = \"red\", se = TRUE) +               # Trendline with confidence interval\n  geom_text_repel(aes(label = paste0(BORO, \" (\", Restaurant_Count, \", \", Rat_Activity_Count, \")\")),\n                  size = 4, color = \"black\", box.padding = 0.5) +      # Add BORO and coordinates\n  scale_y_continuous(labels = comma) +                                 # Format y-axis as whole numbers\n  scale_x_continuous(labels = comma) +                                 # Format x-axis as whole numbers\n  labs(title = \"Density of Restaurants vs Rat Activity\",\n       subtitle = \"Analyzing Relationship Between Restaurants and Rat Infestation Rates\",\n       x = \"Number of Restaurants (Density)\",\n       y = \"Number of Rat Activity Inspections\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\nPositive Correlation:\n\nThe graph shows a slight positive correlation between the number of restaurants (restaurant density) and the number of rat activity inspections.\nBoroughs with higher restaurant density, such as Manhattan and Brooklyn, also exhibit higher rat activity inspections.\n\nManhattan and Brooklyn:\n\nThese boroughs have the highest restaurant densities (e.g., Manhattan: ~94,661 restaurants) and significant rat activity counts (e.g., 136,963 inspections).\nThis suggests that areas with concentrated restaurant activity may experience increased rat infestations due to factors such as waste generation.\n\nLow-Density Areas:\n\nStaten Island has the lowest restaurant density (~9,218 restaurants) and rat activity inspections (~2,049). This aligns with the general trend that lower restaurant density areas tend to have lower rat activity.\n\nOutliers:\n\nThe Bronx appears to have a higher number of rat activity inspections relative to its restaurant density (~23,274 restaurants, ~96,498 inspections). This could indicate other contributing factors, such as waste management issues or urban infrastructure challenges.\n\n\n\n\n\n\nTargeted Waste Management Policies: Boroughs with higher restaurant density, like Manhattan and Brooklyn, require stricter waste management practices to mitigate rat infestations.\nFurther Investigation: The Bronx’s higher rat activity relative to restaurant density warrants further analysis into non-restaurant-related factors contributing to infestations."
  },
  {
    "objectID": "ndividual_report.html#correlation-between-poor-restaurant-sanitation-and-increased-rat-activity",
    "href": "ndividual_report.html#correlation-between-poor-restaurant-sanitation-and-increased-rat-activity",
    "title": "Final Individual Report",
    "section": "",
    "text": "Boroughs with a higher number of Grade B and C restaurants are more likely to experience elevated rat sighting, particularly in localized ZIP codes. Poor sanitation practices associated with lower restaurant grades likely contribute to rat infestations.\n\nTo address the limitations of missing data and analyze the relationship between poor restaurant sanitation and rat activity, we focused on restaurants with Grades B and C and rat density across ZIP Codes in the five boroughs of New York City: Bronx, Brooklyn, Manhattan, Queens, and Staten Island.\nData Cleaning and Standardization\n\nZIP Code Validation: The data was cleaned and standardized to ensure all ZIP Codes were valid and accurately mapped to their respective boroughs using a ZIP\nCode-to-borough mapping file.\nRestaurant Sanitation Data:\nRestaurants receiving sanitation Grades B and C, which indicate lower sanitation standards, were filtered and counted for each ZIP Code.\nRat Density Data: Rat activity data was filtered to exclude inspections resulting in “Passed” or “Failed for Other R” outcomes. This provided a more\nreliable measure of rat activity by focusing on confirmed rodent sightings or infestations.\n\nMerging and Analysis\nThe cleaned restaurant sanitation data and rat density data were merged using ZIP Codes as the key. This integration allowed us to directly compare the number of restaurants with lower sanitation grades to rat activity within each ZIP Code.\nThis process ensured a comprehensive analysis of how poor sanitation practices in restaurants might correlate with increased rat infestations across New York City neighborhoods.\n\n\nshow the code\n# Step 1: Clean ZIP Codes and Map Boroughs -----------------------------------\nzipcode_mapping &lt;- zipcode_mapping %&gt;%\n  mutate(ZIPCODE = str_trim(as.character(Zipcode)),\n         BOROUGH = str_trim(as.character(Borough)))\n\n# Clean and map restaurant data\nrestaurants_clean &lt;- restaurant_filtered_data %&gt;%\n  mutate(ZIPCODE = str_trim(as.character(ZIPCODE)),\n         ZIPCODE = ifelse(str_length(ZIPCODE) == 5, ZIPCODE, NA)) %&gt;%  # Ensure valid 5-digit ZIP codes\n  filter(!is.na(ZIPCODE)) %&gt;%\n  mutate(BORO = ifelse(is.na(BORO), \n                       zipcode_mapping$BOROUGH[match(ZIPCODE, zipcode_mapping$ZIPCODE)], \n                       BORO))\n\n# Filter for restaurants with Grades B and C\nrestaurants_bc &lt;- restaurants_clean %&gt;%\n  filter(GRADE %in% c(\"B\", \"C\")) %&gt;%\n  group_by(BORO, ZIPCODE) %&gt;%\n  summarise(Restaurants_Grade_BC = n(), .groups = \"drop\")\n\n# Clean and map rat data\nrats_clean &lt;- rats_filtered_data %&gt;%\n  mutate(ZIP_CODE = str_trim(as.character(ZIP_CODE)),\n         ZIP_CODE = ifelse(str_length(ZIP_CODE) == 5, ZIP_CODE, NA)) %&gt;%\n  filter(!is.na(ZIP_CODE), !RESULT %in% c(\"Passed\", \"Failed for Other R\")) %&gt;%\n  mutate(BOROUGH = ifelse(is.na(BOROUGH), \n                          zipcode_mapping$BOROUGH[match(ZIP_CODE, zipcode_mapping$ZIPCODE)], \n                          BOROUGH)) %&gt;%\n  group_by(BOROUGH, ZIP_CODE) %&gt;%\n  summarise(Rat_Density = n(), .groups = \"drop\")\n\n# Step 2: Combine Data -------------------------------------------------------\ncombined_data &lt;- full_join(restaurants_bc, rats_clean, \n                           by = c(\"ZIPCODE\" = \"ZIP_CODE\", \"BORO\" = \"BOROUGH\")) %&gt;%\n  replace_na(list(Restaurants_Grade_BC = 0, Rat_Density = 0))\n\nkable(head(combined_data, 5))\n\n\n\n\n\nBORO\nZIPCODE\nRestaurants_Grade_BC\nRat_Density\n\n\n\n\nBronx\n10451\n103\n4515\n\n\nBronx\n10452\n105\n9205\n\n\nBronx\n10453\n93\n7843\n\n\nBronx\n10454\n91\n1907\n\n\nBronx\n10455\n132\n3159\n\n\n\n\n\nshow the code\n# Step 3: Generate Plots for Each Borough ------------------------------------\nplot_list &lt;- list()\n\nboroughs &lt;- unique(combined_data$BORO)\n\n# Loop through each borough and create plots\nfor (b in boroughs) {\n  data_borough &lt;- combined_data %&gt;% filter(BORO == b)\n  \n  # Plot 1: Number of Restaurants (Grade B and C) by ZIP Code\n  plot_bc &lt;- ggplot(data_borough, aes(x = ZIPCODE, y = Restaurants_Grade_BC, group = 1)) +\n    geom_line(color = \"blue\", size = 1) +\n    geom_point(color = \"blue\", size = 2) +\n    labs(title = paste(\"Number of Restaurants with Grade B and C -\", b),\n         x = \"ZIP Code\", y = \"Number of Restaurants\") +\n    theme_minimal() +\n    theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 10),\n          plot.title = element_text(size = 12, face = \"bold\")) +\n    scale_y_continuous(labels = comma)\n  \n  # Plot 2: Rat Density by ZIP Code\n  plot_rats &lt;- ggplot(data_borough, aes(x = ZIPCODE, y = Rat_Density, group = 1)) +\n    geom_line(color = \"red\", size = 1) +\n    geom_point(color = \"red\", size = 2) +\n    labs(title = paste(\"Rat Sighting per ZIP Code -\", b),\n         x = \"ZIP Code\", y = \"Rat Sighting\") +\n    theme_minimal() +\n    theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 10),\n          plot.title = element_text(size = 12, face = \"bold\")) +\n    scale_y_continuous(labels = comma)\n  \n  # Arrange the two plots vertically (one on top of the other)\n  combined_plot &lt;- grid.arrange(plot_bc, plot_rats, ncol = 1)  # Use ncol = 1 for vertical layout\n  plot_list[[b]] &lt;- combined_plot\n  \n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nBronx:\n\nThe ZIP codes 10457 and 10458 show higher rat density (above 12,000) while also exhibiting a significant number of restaurants with Grade B and C.\nThere seems to be a noticeable link between the increase in rat activity and areas with more restaurants receiving lower grades.\n\nBrooklyn:\n\nZIP codes 11215 and 11222 show the highest rat densities (over 20,000), corresponding to relatively high numbers of restaurants with Grade B and C.\nRat infestations in Brooklyn appear to cluster in specific ZIP codes, suggesting that localized waste management issues may be contributing to the problem.\n\nManhattan:\n\nZIP codes 10013 and 10036 have both the highest number of restaurants with Grade B and C (over 600) and noticeable rat activity.\nDespite a significant concentration of lower-graded restaurants, rat densities remain moderate compared to other boroughs, suggesting more effective urban management in some areas.\n\nQueens:\n\nZIP codes 11385 and 11373 show the highest rat densities and a considerable number of restaurants with Grade B and C.\nRat density appears to peak sharply in specific ZIP codes, correlating with localized concentrations of lower-graded restaurants.\n\nStaten Island:\n\nStaten Island has the lowest rat  across all ZIP codes, with a small number of lower-graded restaurants.\nZIP code 10301 has the highest rat density (600) but relatively fewer restaurants compared to other boroughs.\n\n\n\n\nshow the code\noptions(tigris_progress = FALSE)\n\n\nlibrary(tigris)     # Fetch borough boundaries\nlibrary(sf)         # Spatial data\nlibrary(dplyr)      # Data manipulation\nlibrary(ggplot2)    # Visualization\nlibrary(ggrepel)    # Improved text labels\nlibrary(zipcodeR)   # st want to Fetch latitude/longitude for ZIP codes\nlibrary(gganimate)  # Animation\n#options(gganimate.dev = gifski_renderer())\nlibrary(transformr) # Smooth animations\nlibrary(gifski)\nlibrary(av)\n\n\n# Step 1: Fetch NYC Borough Boundaries -----------------------------------------\nnyc_boroughs &lt;- counties(state = \"NY\", cb = TRUE, resolution = \"5m\", year = 2022) %&gt;%\n  filter(NAME %in% c(\"Bronx\", \"Kings\", \"New York\", \"Queens\", \"Richmond\")) # NYC counties\n\n# Calculate centroid of each borough for annotation\nborough_centroids &lt;- nyc_boroughs %&gt;%\n  st_centroid() %&gt;%\n  st_coordinates() %&gt;%\n  as.data.frame() %&gt;%\n  bind_cols(Borough = nyc_boroughs$NAME)\n\n# Step 2: Filter High-Density Data ---------------------------------------------\n# Filter for areas with high restaurant density and rat population\nhigh_density_data &lt;- combined_data %&gt;%\n  filter(Restaurants_Grade_BC &gt; 100 & Rat_Density &gt; 500)\n\n# Step 3: Add Coordinates to ZIP Codes -----------------------------------------\n# Fetch latitude and longitude for ZIP codes using zipcodeR\nhigh_density_data &lt;- high_density_data %&gt;%\n  mutate(coords = purrr::map(ZIPCODE, reverse_zipcode)) %&gt;%\n  tidyr::unnest_wider(coords) %&gt;% \n  filter(!is.na(lat) & !is.na(lng)) %&gt;% # Ensure valid coordinates\n  rename(Longitude = lng, Latitude = lat) %&gt;%\n  arrange(BORO, ZIPCODE) %&gt;%  # Arrange for animation\n  mutate(step = row_number()) # Add animation sequence\n\n# Update borough names\nborough_centroids &lt;- borough_centroids %&gt;%\n  mutate(Borough = case_when(\n    Borough == \"New York\" ~ \"Manhattan\",\n    Borough == \"Kings\" ~ \"Brooklyn\",\n    Borough == \"Richmond\" ~ \"Staten Island\",\n    TRUE ~ Borough\n  ))\n\n# Step 4: Create the Animated Map with Borough Annotations ---------------------\nanimated_map &lt;- ggplot() +\n  # Plot borough boundaries\n  geom_sf(data = nyc_boroughs, fill = \"lightgray\", color = \"white\") +\n  \n  # Add borough names at centroid positions\n  geom_text(data = borough_centroids, \n            aes(x = X, y = Y, label = Borough), \n            color = \"black\", size = 5, fontface = \"bold\") +\n\n  # Add animated pins for high-density areas\n  geom_point(data = high_density_data, \n             aes(x = Longitude, y = Latitude, group = step), \n             color = \"red\", size = 3) +\n  \n  # Add ZIP Code labels\n  geom_text_repel(data = high_density_data, \n                  aes(x = Longitude, y = Latitude, label = ZIPCODE), \n                  size = 3) +\n  \n  # Titles and captions\n  labs(title = \"High-Density Restaurant and Rat Population Areas in NYC\",\n       subtitle = \"Sequential display of ZIP Codes with high density\",\n       caption = \"Data Source: NYC Open Data & tigris\") +\n  \n  # Animation\n  transition_reveal(along = step) +  # Sequential animation\n  enter_grow() +                     # Pins grow as they appear\n  exit_fade() +                      # Optional: Pins fade out\n  theme_minimal()\n\n# Step 5: Render and Save the Animation ----------------------------------------\n# animate(animated_map, nframes = 50, fps = 2, width = 600, height = 400, renderer = gifski_renderer())\n\n# anim_save(\"nyc_high_density_animation.gif\")\n# \n# knitr::include_graphics(\"nyc_high_density_animation.gif\")\n\n\n\n\n\n\n\nLocalized Rat Clusters:\n\nRat density is not uniformly distributed; specific ZIP codes within boroughs, such as 10457 (Bronx) and 11215 (Brooklyn), experience disproportionately high rat activity.\n\nBorough-Specific Trends:\n\nManhattan: Despite high restaurant density, rat activity remains moderate.\nBrooklyn and Bronx: Exhibit stronger correlations between rat density and restaurants with lower grades.\nStaten Island: Shows consistently lower rat activity, indicating better overall sanitation.\n\nTargeted Interventions:\n\nZIP codes with high numbers of Grade B and C restaurants should be prioritized for sanitation inspections and waste management improvements to reduce rat activity.\n\n\n\n\n\nThe analysis highlights a positive relationship between the number of restaurants with lower grades (B and C) and rat activity density, especially in high-density boroughs like the Bronx, Brooklyn, and Queens. Effective sanitation practices and targeted interventions in identified ZIP codes are critical to addressing this issue."
  },
  {
    "objectID": "ndividual_report.html#outdoor-dining-and-its-impact-on-rat-infestation-in-nyc",
    "href": "ndividual_report.html#outdoor-dining-and-its-impact-on-rat-infestation-in-nyc",
    "title": "Final Individual Report",
    "section": "",
    "text": "Outdoor dining in New York City became a significant part of the restaurant scene, particularly during the COVID-19 pandemic, when it was rapidly expanded to allow restaurants to operate on sidewalks, streets, and other open spaces. While this initiative provided safer dining options and supported businesses, it also brought challenges related to sanitation and waste management. Food scraps, improperly stored trash, and debris from outdoor setups created an environment that attracted pests, particularly rats, leading to increased health code violations and rat sightings.\nTo analyze if outdoor dining has caused an increase in rat infestations, we will compare rat sightings near outdoor dining violations over time. By identifying outdoor seating violations and checking for rat inspections within a 100-meter radius, we can observe patterns and trends. Specifically, we will focus on the pandemic years (2020-2022) when outdoor dining expanded significantly, to determine if rat infestation rates increased in these areas compared to previous years.\n\n\n\nThe increase in outdoor seating violations after COVID (2020-2022) may have contributed to higher rat infestation rates. This could be due to improper waste management and sanitation practices around outdoor dining areas.\n\n\n\nshow the code\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(geosphere)\nlibrary(lubridate)\n\n\n# Filter rat inspections with valid lat/lon and failed results\nrats_filtered_loc &lt;- rats_filtered_data %&gt;%\n  filter(!is.na(LATITUDE) & !is.na(LONGITUDE) & RESULT != \"Passed\") %&gt;%\n  mutate(YEAR = year(mdy_hms(INSPECTION_DATE)))\n\n# Extract outdoor seating violations from restaurants\noutdoor_seating &lt;- restaurant_filtered_data %&gt;%\n  filter(grepl(\"outdoor|seating|sidewalk\", `VIOLATION DESCRIPTION`, ignore.case = TRUE)) %&gt;%\n  filter(!is.na(Latitude) & !is.na(Longitude)) %&gt;%\n  mutate(YEAR = year(mdy(`INSPECTION DATE`)))\n\n# Select coordinates for rats and outdoor seating\noutdoor_coords &lt;- outdoor_seating %&gt;% \n  select(Latitude, Longitude) %&gt;% \n  filter(!is.na(Latitude) & !is.na(Longitude)) %&gt;%\n  na.omit()\n\nrat_coords &lt;- rats_filtered_loc %&gt;% \n  select(LATITUDE, LONGITUDE) %&gt;%\n  filter(!is.na(LATITUDE) & !is.na(LONGITUDE)) %&gt;%\n  na.omit()\n\n# Function to check for nearby rats (100 meters)\nfind_rats_nearby &lt;- function(outdoor_coords, rat_coords, distance_threshold = 100) {\n  # Ensure both inputs are matrices with exactly two columns\n  rat_coords &lt;- as.matrix(rat_coords[, c(1, 2)])\n  outdoor_coords &lt;- as.matrix(outdoor_coords[, c(1, 2)])\n  \n  # Validate column names and types\n  if (ncol(rat_coords) != 2 | ncol(outdoor_coords) != 2) {\n    stop(\"Error: Inputs must have exactly two columns (latitude, longitude).\")\n  }\n  \n  result &lt;- sapply(1:nrow(outdoor_coords), function(i) {\n    point &lt;- outdoor_coords[i, ]  # Current restaurant coordinates\n    distances &lt;- distHaversine(matrix(point, nrow = 1), rat_coords)  # Distance to all rat points\n    any(distances &lt;= distance_threshold)  # TRUE if within threshold\n  })\n  return(result)\n}\n\n# Apply the corrected function\noutdoor_seating$RAT_INFESTATION_NEARBY &lt;- find_rats_nearby(outdoor_coords, rat_coords)\n\n\n# Select specific columns\nselected_columns &lt;- outdoor_seating %&gt;%\n  select(\"DBA\",\"BORO\",\"ZIPCODE\", \"YEAR\",`VIOLATION CODE`, 'RAT_INFESTATION_NEARBY')\n\n# Print the selected columns\nkable(head(selected_columns, 6))\n\n\n\n\n\n\n\n\n\n\n\n\n\nDBA\nBORO\nZIPCODE\nYEAR\nVIOLATION CODE\nRAT_INFESTATION_NEARBY\n\n\n\n\nBLUESTONE LANE\nManhattan\n10128\n2024\n28-07\nTRUE\n\n\nSTEVE’S ORIGINAL JERK CHICKEN\nBrooklyn\n11203\n2022\n28-07\nTRUE\n\n\nG & S RESTAURANT\nBronx\n10466\n2024\n28-07\nTRUE\n\n\nTWO BROTHERS FISH & CHIPS\nBrooklyn\n11206\n2023\n28-07\nTRUE\n\n\nZOUJI BBQ\nQueens\n11355\n2024\n28-07\nTRUE\n\n\nNIEVES TIA MIMI ICES\nBrooklyn\n11220\n2024\n28-07\nTRUE\n\n\n\n\n\nshow the code\n# Group by year and count rat infestations near outdoor seating violations\nrat_summary &lt;- outdoor_seating %&gt;%\n  filter(RAT_INFESTATION_NEARBY == TRUE) %&gt;%\n  group_by(YEAR) %&gt;%\n  summarise(Rat_Infestations = n())\n\n# Summarize total outdoor seating violations by year\noutdoor_summary &lt;- outdoor_seating %&gt;%\n  group_by(YEAR) %&gt;%\n  summarise(Outdoor_Violations = n())\n\n# Combine the two summaries\ncombined_summary &lt;- full_join(outdoor_summary, rat_summary, by = \"YEAR\") %&gt;%\n  replace_na(list(Outdoor_Violations = 0, Rat_Infestations = 0))\n\n# Visualization --------------------------------------------------------------\nggplot(combined_summary, aes(x = YEAR)) +\n  geom_bar(aes(y = Outdoor_Violations, fill = \"Outdoor Violations\"), \n           stat = \"identity\", position = \"dodge\") +\n  geom_line(aes(y = Rat_Infestations, color = \"Rat Infestations\"), size = 1) +\n  scale_fill_manual(values = c(\"Outdoor Violations\" = \"steelblue\")) +\n  scale_color_manual(values = c(\"Rat Infestations\" = \"red\")) +\n  geom_rect(aes(xmin = 2020, xmax = 2022, ymin = 0, ymax = Inf), \n            fill = \"gray\", alpha = 0.2) +\n  labs(title = \"Impact of Outdoor Seating on Rat Infestation Rates\",\n       subtitle = \"Highlighted COVID Period (2020-2022)\",\n       x = \"Year\", y = \"Count\",\n       fill = \"Legend\", color = \"Legend\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\nOutdoor Violations:\n\nThere was a clear increase in outdoor seating violations after 2022.\nThe violations appear to be highest in 2024, following a gradual rise from 2022 to 2024.\n\nRat Infestation Rates:\n\nRat infestations near outdoor seating violations also showed a consistent upward trend, increasing sharply in 2023 and 2024.\nThe correlation suggests that as outdoor seating violations increase, rat infestations also rise.\n\nCOVID Period (2020-2022):\n\nThe shaded gray area highlights the COVID period (2020-2022), where the counts of outdoor seating violations and rat infestations were relatively lower compared to post-COVID years.\nPost-2022, there is a notable rise in both outdoor violations and rat infestations.\n\n\n\n\n\n\nPost-COVID: The rise/ existing in unauthorized outdoor dining, lack of proper waste management, street cooking, and similar\nactivities have likely exacerbated rat infestations, emphasizing the importance of effective waste management.\nPreventative Measures: To mitigate rat infestations, stricter enforcement of sanitation protocols for outdoor seating areas is necessary, especially in periods of increased outdoor dining activity.\n\n\n\n\nWe can see a positive relationship between the increase in outdoor seating violations and rat infestation, particularly in 2024."
  },
  {
    "objectID": "ndividual_report.html#the-new-normal-ah-rats",
    "href": "ndividual_report.html#the-new-normal-ah-rats",
    "title": "Final Individual Report",
    "section": "",
    "text": "(Relevant article)\nA report by Elazar Sontag in Eater (December 14, 2021) provides critical insights into the rise of rat infestations in New York City post-COVID-19, aligning with my findings on the impact of outdoor dining. The article shares a specific incident at a Brooklyn wine bar where an unusual smell was traced to something decaying beneath the outdoor dining structure, inaccessible without tearing up the entire parklet. This story highlights how outdoor dining setups, while beneficial for restaurants, inadvertently created new habitats for rats by providing shelter and easier access to food waste.\nI think we can all agree that during the peak of COVID-19 in 2020, rat populations initially declined due to the closure of restaurants, which limited food availability. Sontag’s article describes reports of starving rats resorting to cannibalism as food sources dwindled. However, the reopening of restaurants, particularly with outdoor dining spaces and street-side cooking, reversed this trend by creating an abundance of food once again. As a result, rats rapidly reappeared, with infestations increasing across neighborhoods.\nThis finding aligns with my analysis, which shows a notable correlation between rat activity and outdoor dining violations post-COVID. The lack of adequate waste management in outdoor setups further exacerbated the problem, leading to lawsuits demanding stricter sanitation measures and reconsideration of outdoor dining practices. The issue is not unique to NYC; cities like New Orleans, Chicago, and Los Angeles have reported unprecedented increases in rat sightings following the rise of outdoor dining. These observations emphasize the need for improved waste management strategies to address the unintended consequences of outdoor dining on urban rat infestations."
  },
  {
    "objectID": "ndividual_report.html#restaurants-a-vital-part-of-nyc-and-their-role-in-rat-infestation",
    "href": "ndividual_report.html#restaurants-a-vital-part-of-nyc-and-their-role-in-rat-infestation",
    "title": "Final Individual Report",
    "section": "",
    "text": "Restaurants are a key part of NYC’s culture and economy, providing jobs, tourism, and vibrant dining spaces. However, poor sanitation and the rise of outdoor dining have contributed to rat infestations by increasing food waste and trash.\nNow, we will analyze the correlation between restaurant density and rat population across NYC boroughs. Higher restaurant density, especially those with poor grades (B and C), may attract and sustain larger rat populations, highlighting the connection between restaurant presence and rat infestations in NYC.\n\n\n\nHigher restaurant density contributes to increased rat activity due to improper waste management, food availability, and urban environmental factors.\n\n\n\nshow the code\n# Step 1: Prepare ZIP Code Mapping -------------------------------------------\nzipcode_mapping &lt;- zipcode_mapping %&gt;%\n  mutate(ZIPCODE = str_trim(as.character(Zipcode)),\n         BOROUGH = str_trim(as.character(Borough)))\n\n# Step 2: Fill NA or Invalid BORO in Restaurant Data -------------------------\nrestaurant_filtered_zb &lt;- restaurant_filtered_data %&gt;%\n  mutate(ZIPCODE = str_trim(as.character(ZIPCODE)),  # Trim and convert ZIPCODE\n         BORO = ifelse(is.na(BORO) | BORO == \"0\", \n                       coalesce(zipcode_mapping$BOROUGH[match(ZIPCODE, zipcode_mapping$ZIPCODE)], BORO),\n                       BORO))\n\n# Step 3: Fill NA or Invalid BOROUGH in Rat Data -----------------------------\nrats_filtered_zb &lt;- rats_filtered_data %&gt;%\n  mutate(ZIP_CODE = str_trim(as.character(ZIP_CODE)),  # Trim and convert ZIP_CODE\n         BOROUGH = coalesce(zipcode_mapping$BOROUGH[match(ZIP_CODE, zipcode_mapping$ZIPCODE)], BOROUGH))\n\n\n# Step 2: Filter Rat Data for Rat Activity -----------------------------------\nrat_activity &lt;- rats_filtered_zb %&gt;%\n  filter(!RESULT %in% c(\"Passed\", \"Failed for Other R\")) %&gt;%\n  filter(!is.na(LATITUDE) & !is.na(LONGITUDE)) %&gt;%\n  group_by(BOROUGH) %&gt;%\n  summarise(Rat_Activity_Count = n())\n\n# Step 3: Aggregate Restaurant Data by Borough ------------------------------\nrestaurant_density &lt;- restaurant_filtered_zb %&gt;%\n  filter(!is.na(Latitude) & !is.na(Longitude)) %&gt;%\n  group_by(BORO) %&gt;%\n  summarise(Restaurant_Count = n())\n\n# Step 4: Merge Data ---------------------------------------------------------\ndensity_data &lt;- restaurant_density %&gt;%\n  mutate(BORO = str_to_lower(str_trim(BORO))) %&gt;%\n  inner_join(\n    rat_activity %&gt;%\n      mutate(BOROUGH = str_to_lower(str_trim(BOROUGH))),\n    by = c(\"BORO\" = \"BOROUGH\")\n  )\n\n# Step 5: Visualization ------------------------------------------------------\n\nggplot(density_data, aes(x = Restaurant_Count, y = Rat_Activity_Count, label = BORO)) +\n  geom_point(size = 4, color = \"blue\") +                               # Scatter points\n  geom_smooth(method = \"lm\", color = \"red\", se = TRUE) +               # Trendline with confidence interval\n  geom_text_repel(aes(label = paste0(BORO, \" (\", Restaurant_Count, \", \", Rat_Activity_Count, \")\")),\n                  size = 4, color = \"black\", box.padding = 0.5) +      # Add BORO and coordinates\n  scale_y_continuous(labels = comma) +                                 # Format y-axis as whole numbers\n  scale_x_continuous(labels = comma) +                                 # Format x-axis as whole numbers\n  labs(title = \"Density of Restaurants vs Rat Activity\",\n       subtitle = \"Analyzing Relationship Between Restaurants and Rat Infestation Rates\",\n       x = \"Number of Restaurants (Density)\",\n       y = \"Number of Rat Activity Inspections\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\nPositive Correlation:\n\nThe graph shows a slight positive correlation between the number of restaurants (restaurant density) and the number of rat activity inspections.\nBoroughs with higher restaurant density, such as Manhattan and Brooklyn, also exhibit higher rat activity inspections.\n\nManhattan and Brooklyn:\n\nThese boroughs have the highest restaurant densities (e.g., Manhattan: ~94,661 restaurants) and significant rat activity counts (e.g., 136,963 inspections).\nThis suggests that areas with concentrated restaurant activity may experience increased rat infestations due to factors such as waste generation.\n\nLow-Density Areas:\n\nStaten Island has the lowest restaurant density (~9,218 restaurants) and rat activity inspections (~2,049). This aligns with the general trend that lower restaurant density areas tend to have lower rat activity.\n\nOutliers:\n\nThe Bronx appears to have a higher number of rat activity inspections relative to its restaurant density (~23,274 restaurants, ~96,498 inspections). This could indicate other contributing factors, such as waste management issues or urban infrastructure challenges.\n\n\n\n\n\n\nTargeted Waste Management Policies: Boroughs with higher restaurant density, like Manhattan and Brooklyn, require stricter waste management practices to mitigate rat infestations.\nFurther Investigation: The Bronx’s higher rat activity relative to restaurant density warrants further analysis into non-restaurant-related factors contributing to infestations."
  },
  {
    "objectID": "ndividual_report.html#limitations-of-our-assumptions",
    "href": "ndividual_report.html#limitations-of-our-assumptions",
    "title": "Final Individual Report",
    "section": "Limitations of Our Assumptions",
    "text": "Limitations of Our Assumptions\n\nData Quality: Our analysis relies on inspection data, which may not capture all instances of rat activity or sanitation violations. Underreporting or delayed reporting could affect the results.\nSpatial Accuracy: We assume a 100-meter radius for rat sightings around outdoor dining violations, which may not accurately reflect rats’ mobility or the true impact area.\nCausality vs. Correlation: While we found correlations between restaurant density, sanitation, and rat activity, this does not prove direct causality. Other\nunderlying factors might contribute to the observed patterns.\nCOVID-19 Impact: The unique circumstances of the COVID-19 pandemic, such as temporary outdoor dining policies and changes in waste management services, could distort long-term trends."
  },
  {
    "objectID": "individual_report.html#the-new-normal-ah-rats",
    "href": "individual_report.html#the-new-normal-ah-rats",
    "title": "Final Individual Report",
    "section": "",
    "text": "(Relevant article)\nA report by Elazar Sontag in Eater (December 14, 2021) provides critical insights into the rise of rat infestations in New York City post-COVID-19, aligning with my findings on the impact of outdoor dining. The article shares a specific incident at a Brooklyn wine bar where an unusual smell was traced to something decaying beneath the outdoor dining structure, inaccessible without tearing up the entire parklet. This story highlights how outdoor dining setups, while beneficial for restaurants, inadvertently created new habitats for rats by providing shelter and easier access to food waste.\nI think we can all agree that during the peak of COVID-19 in 2020, rat populations initially declined due to the closure of restaurants, which limited food availability. Sontag’s article describes reports of starving rats resorting to cannibalism as food sources dwindled. However, the reopening of restaurants, particularly with outdoor dining spaces and street-side cooking, reversed this trend by creating an abundance of food once again. As a result, rats rapidly reappeared, with infestations increasing across neighborhoods.\nThis finding aligns with my analysis, which shows a notable correlation between rat activity and outdoor dining violations post-COVID. The lack of adequate waste management in outdoor setups further exacerbated the problem, leading to lawsuits demanding stricter sanitation measures and reconsideration of outdoor dining practices. The issue is not unique to NYC; cities like New Orleans, Chicago, and Los Angeles have reported unprecedented increases in rat sightings following the rise of outdoor dining. These observations emphasize the need for improved waste management strategies to address the unintended consequences of outdoor dining on urban rat infestations.\n\n\n\nPost-COVID: The rise/ existing in unauthorized outdoor dining, lack of proper waste management, street cooking, and similar activities have likely exacerbated rat infestations, emphasizing the importance of effective waste management.\nPreventative Measures: To mitigate rat infestations, stricter enforcement of sanitation protocols for outdoor seating areas is necessary, especially in periods of increased outdoor dining activity.\n\n\n\n\nWe can see a positive relationship between the increase in outdoor seating violations and rat infestation, particularly in 2024."
  },
  {
    "objectID": "individual_report.html#summary",
    "href": "individual_report.html#summary",
    "title": "Final Individual Report",
    "section": "",
    "text": "Our analysis demonstrates a clear relationship between rat infestations in NYC and factors such as poor sanitation, restaurant density, and the expansion of outdoor dining. We found that areas with higher concentrations of restaurants, particularly those with grades B and C, tend to experience increased rat activity. Poor waste management, exacerbated by outdoor dining setups, creates conditions that attract and sustain rat populations. Boroughs like Manhattan and Brooklyn, with the highest restaurant density, showed the strongest correlation with rat infestations."
  },
  {
    "objectID": "individual_report.html#proposal-for-future-work",
    "href": "individual_report.html#proposal-for-future-work",
    "title": "Final Individual Report",
    "section": "",
    "text": "Our analysis has revealed significant correlations between poor restaurant grades (B and C), rat activity, restaurant density, and the impact of outdoor dining on rat infestations across NYC neighborhoods. While these findings provide important insights, further work is needed to deepen our understanding and address limitations. Below are key proposals for future work:\n\nBorough-Level and Neighborhood-Specific Analysis\n\nConduct a detailed analysis at the borough and neighborhood levels to identify localized trends and specific hotspots. This will help target interventions in areas with the highest rat activity and poor restaurant sanitation.\n\nComparison with Other Cities\n\nConduct a comparative analysis with data from other major cities to understand how NYC’s rat infestation problem aligns with or differs from similar urban areas. This can offer best practices for managing sanitation and rat control.\n\nPublic Behavior and Policy Impact\n\nAssess the role of public behavior (e.g., littering, improper waste disposal) and evaluate the effectiveness of existing sanitation policies. Surveys or community-level data can provide insights into how public education campaigns and enforcement influence rat activity.\n\nTemporal Trends and Longitudinal Analysis\n\nExpand the analysis to include multi-year data to examine how rat activity changes over time, particularly before, during, and after the COVID-19 pandemic. Investigating seasonal trends will also help determine when rat infestations peak and how outdoor dining contributes to this cycle."
  },
  {
    "objectID": "Final summary report.html",
    "href": "Final summary report.html",
    "title": "Final_summary_report",
    "section": "",
    "text": "Do restaurants play a significant role in contribution to rat infestation?\nToday if we see around us in New York City, we see rats every where, literally! It is us humans who are living in their city and not the other way around. So, among other factors discussed above how do restaurant contribute to this city emergency?\nTo begin with our analysis we have chosen DOHMH New York City Restaurant Inspection Results and Rats activity recorded in restaurants by borough datasets because they provide exactly what we needed to explore the link between restaurant practices and rat infestations in NYC. The restaurant inspection data includes sanitation grades and violations, which helped us focus on places with poor hygiene (Grades B and C), while the rat activity data tracks inspections and sightings across neighborhoods. Since both datasets include ZIP codes and borough information, they allowed us to analyze where rat problems are most common and how they relate to restaurant density and sanitation issues.\nHowever, there are limitation to these open sources. First, the rat activity data reflects only inspected areas, which can create bias by making neighborhoods with more inspections appear to have higher rat densities, even if that isn’t the case. Second, both datasets contain incomplete records, such as missing ZIP Codes, sanitation grades, or inspection outcomes, which required filtering and cleaning that may have excluded some valuable data points. Lastly, there are time gaps and reporting inconsistencies between restaurant inspections and rat activity reports, making it difficult to perfectly align the data and establish direct cause-and-effect relationships.\nLet us now dig deeper to further understand this relationship between rats and restaurants.\ndoes poor restaurant sanitation have a direct contribution to rat infestation?\nUtilizing our data after cleaning and combining them as per our requirement, we filtered the restaurants with Grades B and C in different Zip Codes throughout the borough and violation description to rat activity in sight."
  },
  {
    "objectID": "html.html",
    "href": "html.html",
    "title": "Final_summary_report",
    "section": "",
    "text": "If you look around New York City today, it feels like rats are everywhere—almost as if we’re living in their city and not the other way around. So, how exactly do restaurants contribute to this growing urban emergency among other factors?\nTo explore this question, we used the DOHMH New York City Restaurant Inspection Results and Rats activity recorded in restaurants by borough data sets. These data sets were ideal for our analysis as they provided comprehensive information on restaurant sanitation grades, violations, and rat activity inspections across neighborhoods. The restaurant inspection data allowed us to focus on establishments with poor sanitation (Grades B and C), while the rat activity data captured sightings and inspection outcomes, enabling us to analyze trends at the ZIP Code and borough levels. Together, these datasets helped us identify where rat infestations are most prevalent and how they correlate with restaurant density and hygiene practices.\nHowever, there are limitation to these open sources. First, the rat activity data reflects only inspected areas, which can create bias by making neighborhoods with more inspections appear to have higher rat densities, even if that isn’t the case. Second, both data sets contain incomplete records, such as missing ZIP Codes, sanitation grades, or inspection outcomes, which required filtering and cleaning that may have excluded some valuable data points. Lastly, there are time gaps and reporting inconsistencies between restaurant inspections and rat activity reports, making it difficult to perfectly align the data and establish direct cause-and-effect relationships.\n\n\nAfter cleaning and combining the datasets, we focused on restaurants with Grades B and C across various ZIP Codes in NYC boroughs. By filtering violation descriptions and mapping these to rat activity data, we aimed to uncover how poor restaurant sanitation correlates with increased rat infestations in these areas. Let’s dig deeper into the findings to understand this relationship further.\n     \nFrom our graph above we can observe that rat infestations are not uniformly distributed across NYC boroughs, with higher activity observed in areas with a greater number of poorly graded restaurants (Grades B and C). In the Bronx, ZIP codes 10457 and 10458 show high rat densities (over 12,000), which aligns with a significant concentration of lower-graded restaurants, suggesting a strong connection between poor sanitation and rat activity. Similarly, Brooklyn, particularly ZIP codes 11215 and 11222, reports the highest rat densities (over 20,000), indicating that localized waste management challenges may exacerbate the problem. In Manhattan, ZIP codes 10013 and 10036 have the most Grade B and C restaurants (over 600), yet rat activity remains moderate, likely due to more effective urban sanitation practices. Queens shows notable peaks in rat density, especially in ZIP codes 11385 and 11373, which also have a high concentration of poorly graded restaurants. On the other hand, Staten Island reports the lowest rat activity, with ZIP code 10301 showing minimal infestations despite fewer sanitation issues.\nOverall, the findings highlight that rat activity tends to cluster in specific ZIP codes where restaurant sanitation is poor. While Manhattan demonstrates moderate rat activity despite high restaurant density, Brooklyn and the Bronx exhibit a stronger correlation between lower sanitation grades and increased rat infestations. Staten Island remains a notable exception, reflecting better sanitation and waste management outcomes. These insights emphasize the need for targeted interventions, such as enhanced sanitation inspections and improved waste management practices, particularly in ZIP codes with higher concentrations of Grade B and C restaurants.\n\n\n\n\nThe visual representation, combining a bar graph and a line graph, highlights the relationship between outdoor seating violations and rat infestations in NYC. The bar graph shows a steady increase in outdoor seating violations post-COVID, particularly from 2022 to 2024, with the highest violations recorded in 2024. Simultaneously, the line graph reveals a consistent upward trend in rat infestations near outdoor seating areas, which sharply rises in 2023 and 2024. This correlation suggests that as outdoor seating violations increased, rat infestations also surged, likely due to improper waste management and expanded food availability. The findings emphasize the need for stricter sanitation protocols to manage outdoor dining spaces and reduce rat activity in NYC neighborhoods.\nThe article “The new Normal, Ah!! Rats!! by Elazar Sontag in Eater (December 14, 2021) supports my analysis by highlighting how the reopening of restaurants and the rise of outdoor dining post-COVID-19 contributed to a resurgence of rat infestations in New York City. During the peak of the pandemic, rat populations initially declined due to reduced food availability caused by restaurant closures. However, with the return of outdoor dining and street-side cooking, food waste became abundant, creating ideal conditions for rats to thrive. This aligns with my findings, which show a clear correlation between outdoor seating violations and increased rat activity after 2022. The article further emphasizes that the issue extends beyond NYC, as other cities like Chicago, Los Angeles, and New Orleans have reported similar increases in rat sightings, underscoring the need for stricter sanitation measures to address these challenges effectively.\n\n\n\n\nFrom the graph above we can see a positive correlation between restaurant density and the number of rat activity inspections across NYC boroughs. Boroughs with higher restaurant density, such as Manhattan and Brooklyn, also report significantly higher rat activity, with Manhattan having approximately 94,661 restaurants and 136,963 inspections. This suggests that concentrated restaurant activity may contribute to increased rat infestations due to greater food waste generation. In contrast, Staten Island, which has the lowest restaurant density (~9,218 restaurants), also reports the fewest rat activity inspections (~2,049), supporting the trend that lower restaurant density aligns with reduced rat activity. However, the Bronx stands out as an outlier, with higher rat activity inspections (~96,498) relative to its moderate restaurant density (~23,274 restaurants), indicating that additional factors, such as waste management issues or urban infrastructure challenges, may be at play. These findings emphasize the need for targeted waste management policies in high-density boroughs like Manhattan and Brooklyn, while further investigation is needed to understand the unique challenges driving rat infestations in the Bronx."
  },
  {
    "objectID": "html.html#do-restaurants-play-a-significant-role-in-contribution-to-rat-infestation",
    "href": "html.html#do-restaurants-play-a-significant-role-in-contribution-to-rat-infestation",
    "title": "Final_summary_report",
    "section": "",
    "text": "If you look around New York City today, it feels like rats are everywhere—almost as if we’re living in their city and not the other way around. So, how exactly do restaurants contribute to this growing urban emergency among other factors?\nTo explore this question, we used the DOHMH New York City Restaurant Inspection Results and Rats activity recorded in restaurants by borough data sets. These data sets were ideal for our analysis as they provided comprehensive information on restaurant sanitation grades, violations, and rat activity inspections across neighborhoods. The restaurant inspection data allowed us to focus on establishments with poor sanitation (Grades B and C), while the rat activity data captured sightings and inspection outcomes, enabling us to analyze trends at the ZIP Code and borough levels. Together, these datasets helped us identify where rat infestations are most prevalent and how they correlate with restaurant density and hygiene practices.\nHowever, there are limitation to these open sources. First, the rat activity data reflects only inspected areas, which can create bias by making neighborhoods with more inspections appear to have higher rat densities, even if that isn’t the case. Second, both data sets contain incomplete records, such as missing ZIP Codes, sanitation grades, or inspection outcomes, which required filtering and cleaning that may have excluded some valuable data points. Lastly, there are time gaps and reporting inconsistencies between restaurant inspections and rat activity reports, making it difficult to perfectly align the data and establish direct cause-and-effect relationships.\n\n\nAfter cleaning and combining the datasets, we focused on restaurants with Grades B and C across various ZIP Codes in NYC boroughs. By filtering violation descriptions and mapping these to rat activity data, we aimed to uncover how poor restaurant sanitation correlates with increased rat infestations in these areas. Let’s dig deeper into the findings to understand this relationship further.\n     \nFrom our graph above we can observe that rat infestations are not uniformly distributed across NYC boroughs, with higher activity observed in areas with a greater number of poorly graded restaurants (Grades B and C). In the Bronx, ZIP codes 10457 and 10458 show high rat densities (over 12,000), which aligns with a significant concentration of lower-graded restaurants, suggesting a strong connection between poor sanitation and rat activity. Similarly, Brooklyn, particularly ZIP codes 11215 and 11222, reports the highest rat densities (over 20,000), indicating that localized waste management challenges may exacerbate the problem. In Manhattan, ZIP codes 10013 and 10036 have the most Grade B and C restaurants (over 600), yet rat activity remains moderate, likely due to more effective urban sanitation practices. Queens shows notable peaks in rat density, especially in ZIP codes 11385 and 11373, which also have a high concentration of poorly graded restaurants. On the other hand, Staten Island reports the lowest rat activity, with ZIP code 10301 showing minimal infestations despite fewer sanitation issues.\nOverall, the findings highlight that rat activity tends to cluster in specific ZIP codes where restaurant sanitation is poor. While Manhattan demonstrates moderate rat activity despite high restaurant density, Brooklyn and the Bronx exhibit a stronger correlation between lower sanitation grades and increased rat infestations. Staten Island remains a notable exception, reflecting better sanitation and waste management outcomes. These insights emphasize the need for targeted interventions, such as enhanced sanitation inspections and improved waste management practices, particularly in ZIP codes with higher concentrations of Grade B and C restaurants.\n\n\n\n\nThe visual representation, combining a bar graph and a line graph, highlights the relationship between outdoor seating violations and rat infestations in NYC. The bar graph shows a steady increase in outdoor seating violations post-COVID, particularly from 2022 to 2024, with the highest violations recorded in 2024. Simultaneously, the line graph reveals a consistent upward trend in rat infestations near outdoor seating areas, which sharply rises in 2023 and 2024. This correlation suggests that as outdoor seating violations increased, rat infestations also surged, likely due to improper waste management and expanded food availability. The findings emphasize the need for stricter sanitation protocols to manage outdoor dining spaces and reduce rat activity in NYC neighborhoods.\nThe article “The new Normal, Ah!! Rats!! by Elazar Sontag in Eater (December 14, 2021) supports my analysis by highlighting how the reopening of restaurants and the rise of outdoor dining post-COVID-19 contributed to a resurgence of rat infestations in New York City. During the peak of the pandemic, rat populations initially declined due to reduced food availability caused by restaurant closures. However, with the return of outdoor dining and street-side cooking, food waste became abundant, creating ideal conditions for rats to thrive. This aligns with my findings, which show a clear correlation between outdoor seating violations and increased rat activity after 2022. The article further emphasizes that the issue extends beyond NYC, as other cities like Chicago, Los Angeles, and New Orleans have reported similar increases in rat sightings, underscoring the need for stricter sanitation measures to address these challenges effectively.\n\n\n\n\nFrom the graph above we can see a positive correlation between restaurant density and the number of rat activity inspections across NYC boroughs. Boroughs with higher restaurant density, such as Manhattan and Brooklyn, also report significantly higher rat activity, with Manhattan having approximately 94,661 restaurants and 136,963 inspections. This suggests that concentrated restaurant activity may contribute to increased rat infestations due to greater food waste generation. In contrast, Staten Island, which has the lowest restaurant density (~9,218 restaurants), also reports the fewest rat activity inspections (~2,049), supporting the trend that lower restaurant density aligns with reduced rat activity. However, the Bronx stands out as an outlier, with higher rat activity inspections (~96,498) relative to its moderate restaurant density (~23,274 restaurants), indicating that additional factors, such as waste management issues or urban infrastructure challenges, may be at play. These findings emphasize the need for targeted waste management policies in high-density boroughs like Manhattan and Brooklyn, while further investigation is needed to understand the unique challenges driving rat infestations in the Bronx."
  },
  {
    "objectID": "html.html#conclusion",
    "href": "html.html#conclusion",
    "title": "Final_summary_report",
    "section": "Conclusion",
    "text": "Conclusion\nThe analysis highlights a clear correlation between restaurant practices and rat infestations in NYC neighborhoods. Poor restaurant sanitation (Grades B and C), increased outdoor dining violations, and high restaurant density are significant contributors to rising rat activity, particularly in boroughs like Brooklyn, the Bronx, and Manhattan. While Staten Island shows minimal rat infestations due to lower restaurant density, the Bronx stands out as an outlier, indicating other factors may be at play. These findings emphasize the urgent need for stricter sanitation protocols, improved waste management practices, and targeted interventions in high-risk areas to address the growing rat infestation issue effectively."
  },
  {
    "objectID": "Final_summary report_rats.html",
    "href": "Final_summary report_rats.html",
    "title": "What influences the likelihood of rat infestations in different NYC neighborhoods?",
    "section": "",
    "text": "## Do restaurants play a significant role in contribution to rat infestation?\nIf you look around New York City today, it feels like rats are everywhere—almost as if we’re living in their city and not the other way around. So, how exactly do restaurants contribute to this growing urban emergency among other factors?\nTo explore this question, we used the DOHMH New York City Restaurant Inspection Results and Rats activity recorded in restaurants by borough data sets. These data sets were ideal for our analysis as they provided comprehensive information on restaurant sanitation grades, violations, and rat activity inspections across neighborhoods. The restaurant inspection data allowed us to focus on establishments with poor sanitation (Grades B and C), while the rat activity data captured sightings and inspection outcomes, enabling us to analyze trends at the ZIP Code and borough levels. Together, these datasets helped us identify where rat infestations are most prevalent and how they correlate with restaurant density and hygiene practices.\nHowever, there are limitation to these open sources. First, the rat activity data reflects only inspected areas, which can create bias by making neighborhoods with more inspections appear to have higher rat densities, even if that isn’t the case. Second, both data sets contain incomplete records, such as missing ZIP Codes, sanitation grades, or inspection outcomes, which required filtering and cleaning that may have excluded some valuable data points. Lastly, there are time gaps and reporting inconsistencies between restaurant inspections and rat activity reports, making it difficult to perfectly align the data and establish direct cause-and-effect relationships."
  },
  {
    "objectID": "Final_summary report_rats.html#do-restaurants-play-a-significant-role-in-contribution-to-rat-infestation",
    "href": "Final_summary report_rats.html#do-restaurants-play-a-significant-role-in-contribution-to-rat-infestation",
    "title": "What influences the likelihood of rat infestations in different NYC neighborhoods?",
    "section": "Do restaurants play a significant role in contribution to rat infestation?",
    "text": "Do restaurants play a significant role in contribution to rat infestation?\nIf you look around New York City today, it feels like rats are everywhere—almost as if we’re living in their city and not the other way around. So, how exactly do restaurants contribute to this growing urban emergency among other factors?\nTo explore this question, we used the DOHMH New York City Restaurant Inspection Results and Rats activity recorded in restaurants by borough data sets. These data sets were ideal for our analysis as they provided comprehensive information on restaurant sanitation grades, violations, and rat activity inspections across neighborhoods. The restaurant inspection data allowed us to focus on establishments with poor sanitation (Grades B and C), while the rat activity data captured sightings and inspection outcomes, enabling us to analyze trends at the ZIP Code and borough levels. Together, these datasets helped us identify where rat infestations are most prevalent and how they correlate with restaurant density and hygiene practices.\nHowever, there are limitation to these open sources. First, the rat activity data reflects only inspected areas, which can create bias by making neighborhoods with more inspections appear to have higher rat densities, even if that isn’t the case. Second, both data sets contain incomplete records, such as missing ZIP Codes, sanitation grades, or inspection outcomes, which required filtering and cleaning that may have excluded some valuable data points. Lastly, there are time gaps and reporting inconsistencies between restaurant inspections and rat activity reports, making it difficult to perfectly align the data and establish direct cause-and-effect relationships.\n\nPoor restaurant sanitation\nAfter cleaning and combining the datasets, we focused on restaurants with Grades B and C across various ZIP Codes in NYC boroughs. By filtering violation descriptions and mapping these to rat activity data, we aimed to uncover how poor restaurant sanitation correlates with increased rat infestations in these areas. Let’s dig deeper into the findings to understand this relationship further.\n\nIn the Bronx, ZIP codes 10457 and 10458 show high rat densities (over 12,000), which aligns with a significant concentration of lower-graded restaurants, suggesting a strong connection between poor sanitation and rat activity.\n\nBrooklyn, particularly ZIP codes 11215 and 11222, reports the highest rat densities (over 20,000), indicating that localized waste management challenges may exacerbate the problem.\n\nIn Manhattan, ZIP codes 10013 and 10036 have the most Grade B and C restaurants (over 600), yet rat activity remains moderate, likely due to more effective urban sanitation practices.\n\nQueens shows notable peaks in rat density, especially in ZIP codes 11385 and 11373, which also have a high concentration of poorly graded restaurants.\n\nStaten Island reports the lowest rat activity, with ZIP code 10301 showing minimal infestations despite fewer sanitation issues.\n\nFrom our graph above we can observe that rat infestations are not uniformly distributed across NYC boroughs, with higher activity observed in areas with a greater number of poorly graded restaurants (Grades B and C).\nOverall, the findings highlight that rat activity tends to cluster in specific ZIP codes where restaurant sanitation is poor. While Manhattan demonstrates moderate rat activity despite high restaurant density, Brooklyn and the Bronx exhibit a stronger correlation between lower sanitation grades and increased rat infestations. Staten Island remains a notable exception, reflecting better sanitation and waste management outcomes. These insights emphasize the need for targeted interventions, such as enhanced sanitation inspections and improved waste management practices, particularly in ZIP codes with higher concentrations of Grade B and C restaurants.\n\n\nOutdoor dining\n\nThe visual representation, combining a bar graph and a line graph, highlights the relationship between outdoor seating violations and rat infestations in NYC. The bar graph shows a steady increase in outdoor seating violations post-COVID, particularly from 2022 to 2024, with the highest violations recorded in 2024. Simultaneously, the line graph reveals a consistent upward trend in rat infestations near outdoor seating areas, which sharply rises in 2023 and 2024. This correlation suggests that as outdoor seating violations increased, rat infestations also surged, likely due to improper waste management and expanded food availability. The findings emphasize the need for stricter sanitation protocols to manage outdoor dining spaces and reduce rat activity in NYC neighborhoods.\nThe article “The new Normal, Ah!! Rats!! by Elazar Sontag in Eater (December 14, 2021) supports my analysis by highlighting how the reopening of restaurants and the rise of outdoor dining post-COVID-19 contributed to a resurgence of rat infestations in New York City. During the peak of the pandemic, rat populations initially declined due to reduced food availability caused by restaurant closures. However, with the return of outdoor dining and street-side cooking, food waste became abundant, creating ideal conditions for rats to thrive. This aligns with my findings, which show a clear correlation between outdoor seating violations and increased rat activity after 2022. The article further emphasizes that the issue extends beyond NYC, as other cities like Chicago, Los Angeles, and New Orleans have reported similar increases in rat sightings, underscoring the need for stricter sanitation measures to address these challenges effectively.\n\n\nRestaurant Density in a neighbourhood\n\nFrom the graph above we can see a positive correlation between restaurant density and the number of rat activity inspections across NYC boroughs. Boroughs with higher restaurant density, such as Manhattan and Brooklyn, also report significantly higher rat activity, with Manhattan having approximately 94,661 restaurants and 136,963 inspections. This suggests that concentrated restaurant activity may contribute to increased rat infestations due to greater food waste generation. In contrast, Staten Island, which has the lowest restaurant density (~9,218 restaurants), also reports the fewest rat activity inspections (~2,049), supporting the trend that lower restaurant density aligns with reduced rat activity. However, the Bronx stands out as an outlier, with higher rat activity inspections (~96,498) relative to its moderate restaurant density (~23,274 restaurants), indicating that additional factors, such as waste management issues or urban infrastructure challenges, may be at play. These findings emphasize the need for targeted waste management policies in high-density boroughs like Manhattan and Brooklyn, while further investigation is needed to understand the unique challenges driving rat infestations in the Bronx."
  },
  {
    "objectID": "Final_summary report_rats.html#conclusion",
    "href": "Final_summary report_rats.html#conclusion",
    "title": "What influences the likelihood of rat infestations in different NYC neighborhoods?",
    "section": "Conclusion",
    "text": "Conclusion\nThe analysis highlights a clear correlation between restaurant practices and rat infestations in NYC neighborhoods. Poor restaurant sanitation (Grades B and C), increased outdoor dining violations, and high restaurant density are significant contributors to rising rat activity, particularly in boroughs like Brooklyn, the Bronx, and Manhattan. While Staten Island shows minimal rat infestations due to lower restaurant density, the Bronx stands out as an outlier, indicating other factors may be at play. These findings emphasize the urgent need for stricter sanitation protocols, improved waste management practices, and targeted interventions in high-risk areas to address the growing rat infestation issue effectively."
  }
]